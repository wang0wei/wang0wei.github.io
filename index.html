<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="二十一的博客">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="二十一的博客">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="二十一的博客">





  
  
  <link rel="canonical" href="http://yoursite.com/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>二十一的博客</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">二十一的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/14/Spring框架学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wangwei">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="二十一的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/09/14/Spring框架学习/" class="post-title-link" itemprop="url">Spring框架学习</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-09-14 09:24:22 / 修改时间：09:47:01" itemprop="dateCreated datePublished" datetime="2019-09-14T09:24:22+08:00">2019-09-14</time>
            

            
              

              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Spring框架简介及官方压缩包目录介绍"><a href="#Spring框架简介及官方压缩包目录介绍" class="headerlink" title="Spring框架简介及官方压缩包目录介绍"></a>Spring框架简介及官方压缩包目录介绍</h1><p>（Spring框架不是哪一层的框架，哪里都在）</p>
<ol>
<li><p>主要发明者：Rod Johnson</p>
</li>
<li><p>轮子理论推崇者</p>
</li>
<li><p>Spring框架宗旨：不重新发明技术，让原有技术使用起来更加方便</p>
<ol>
<li>Spring几大核心功能<ol>
<li>IoC/DI：控制反转/依赖注入</li>
<li>AOP：面向切面编程</li>
<li>声明式事务</li>
</ol>
</li>
</ol>
</li>
<li><p>Spring框架runtime</p>
<ol>
<li>Test：spring提供测试功能</li>
<li>Core Container：核心容器。spring启动最基本的条件</li>
<li>Beans：spring负责创建类对象并管理对象</li>
<li>Core：核心类</li>
<li>Context：上下文参数，获取外部资源或者管理注解等</li>
<li>SpEL：expression.jar</li>
<li>AOP：实现aop功能需要的依赖包</li>
<li>Aspects：切面，AOP依赖的包</li>
<li><p>Data Access/Integration：spring封装数据访问层相关内容，例如：由tomcat加载spring配置文件时需要有spring-web.jar</p>
<p>​    <img src="/2019/09/14/Spring框架学习/spring框架.png" title="This is an image"></p>
</li>
</ol>
</li>
<li><p>Spring框架中重要概念</p>
<ol>
<li>容器(Container)：Spring当作一个大容器</li>
<li>BeanFactory接口：老版本的</li>
<li>新版本中ApplicationContext接口，是BeanFactory子接口。BeanFactory的功能在ApplicationContext中都有</li>
</ol>
</li>
<li><p>从Spring3开始把Spring框架的功能拆分成多个jar，Spring2及以前就一个jar</p>
</li>
</ol>
<h1 id="IoC"><a href="#IoC" class="headerlink" title="IoC"></a>IoC</h1><ol>
<li>中文名称：控制反转</li>
<li>英文名称：Inversion of Control</li>
<li>IoC是什么？<ol>
<li>IoC完成的事情原先由程序员主动通过new实例化对象事情，转交给spring负责</li>
</ol>
</li>
<li>控制反转中控制指的是：控制类的对象</li>
<li>控制反转中的反转指的是：转交给spring负责</li>
<li>IoC最大的作用：解耦<ol>
<li>程序员不需要管理对象，解除了对象管理和程序员之间的耦合</li>
</ol>
</li>
</ol>
<h1 id="Spring环境搭建"><a href="#Spring环境搭建" class="headerlink" title="Spring环境搭建"></a>Spring环境搭建</h1><ol>
<li>导jar包<ol>
<li>四个核心包，一个日志包(commons-logging)<ol>
<li>commons-logging.jar</li>
<li>spring-beans.jar</li>
<li>spring-context.jar</li>
<li>spring-core.jar</li>
<li>spring-expression.jar</li>
</ol>
</li>
</ol>
</li>
<li>在src下新建一个applicationContext.xml<ol>
<li>文件名称和路径自定义<ol>
<li>schema文件拓展名.xsd</li>
<li>把schema理解成DTD的升级版，比DTD具备更好的扩展性</li>
<li>每次引入一个xsd文件就是一个namespace(xmlns)</li>
<li>配置文件中只需要引入基本schema<ol>
<li>通过 <code>&lt;bean/&gt;</code>创建对象</li>
<li>默认配置文件加载时创建对象</li>
</ol>
</li>
<li>记住spring容器ApplicationContext，applicationContext.xml配置的信息最终存储到了ApplicationContext容器中</li>
<li>spring配置文件是基于schema</li>
</ol>
</li>
</ol>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- id表示获取到对象的一个标识</span></span><br><span class="line"><span class="comment">     class表示创建哪个类的对象</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"peo"</span> <span class="attr">class</span>=<span class="string">"com.bjsxt.pojo.People"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>编写测试方法<ol>
<li>getBean(“ <code>&lt;bean&gt;</code>标签id值，返回值类型”)；如果没有第二个参数，默认是Object</li>
<li>getBeanDefinitionNames()，Spring容器中目前管理的所有对象</li>
</ol>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ApplicationContext ac=<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"applicationContext.xml"</span>);</span><br><span class="line">		People people = ac.getBean(<span class="string">"peo"</span>,People.class);</span><br><span class="line">		System.out.println(people);</span><br><span class="line">		</span><br><span class="line"><span class="comment">//		String[] names = ac.getBeanDefinitionNames();</span></span><br><span class="line"><span class="comment">//		for(String string:names) &#123;</span></span><br><span class="line"><span class="comment">//			System.out.println(string);</span></span><br><span class="line"><span class="comment">//		&#125;</span></span><br></pre></td></tr></table></figure>
<h1 id="Spring创建对象的三种方式"><a href="#Spring创建对象的三种方式" class="headerlink" title="Spring创建对象的三种方式"></a>Spring创建对象的三种方式</h1><ol>
<li><p>通过构造方法创建</p>
<ol>
<li><p>无参构造创建：默认情况</p>
</li>
<li><p>有参构造创建：需要明确配置</p>
<ol>
<li><p>需要在类中提供有参构造方法</p>
</li>
<li><p>在applicationContext.xml中设置调用哪个构造方法创建对象</p>
</li>
<li><p>如果设定的条件匹配多个构造方法执行最后的构造方法</p>
<ol start="2">
<li><p>index：参数的索引从0开始</p>
</li>
<li><p>name：参数名</p>
</li>
<li><p>type：类型（区分开关键字和封装类  int和Integer）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"peo"</span> <span class="attr">class</span>=<span class="string">"com.bjsxt.pojo.People"</span> &gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- ref引用另一个bean   value基本数据类型或String等 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"0"</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">type</span>=<span class="string">"int"</span> <span class="attr">value</span>=<span class="string">"123"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"1"</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">type</span>=<span class="string">"java.lang.String"</span> <span class="attr">value</span>=<span class="string">"张三"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li><p>实例工厂</p>
<ol>
<li><p>工厂设计模式：帮助创建类对象，一个工厂可以生产多个对象</p>
</li>
<li><p>实例工厂：需要先创建工厂，才能生产对象</p>
</li>
<li><p>实现步骤：</p>
<ol>
<li><p>必须要有一个实例工厂</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PeopleFactory</span> </span>&#123;</span><br><span class="line">   	<span class="function"><span class="keyword">public</span> People <span class="title">newInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   		<span class="keyword">return</span> <span class="keyword">new</span> People(<span class="number">1</span>,<span class="string">"测试"</span>);</span><br><span class="line">   	&#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<ol start="2">
<li><p>在applicationContext.xml中配置工厂对象和需要创建的对象</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"factory"</span> <span class="attr">class</span>=<span class="string">"com.bjsxt.pojo.PeopleFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"peo1"</span> <span class="attr">factory-bean</span>=<span class="string">"factory"</span> <span class="attr">factory-method</span>=<span class="string">"newInstance"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol start="3">
<li><p>静态工厂</p>
<ol>
<li><p>不需要创建工厂，快速创建对象</p>
</li>
<li><p>实现步骤</p>
<ol>
<li><p>编写一个静态工厂（在方法上添加static）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PeopleFactory</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> People <span class="title">newInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> People(<span class="number">1</span>,<span class="string">"测试"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在applicationContext.xml中</p>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"peo2"</span> <span class="attr">class</span>=<span class="string">"com.bjsxt.pojo.PeopleFactory"</span> <span class="attr">factory-method</span>=<span class="string">"newInstance"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
<h1 id="如何给Bean的属性赋值（注入）"><a href="#如何给Bean的属性赋值（注入）" class="headerlink" title="如何给Bean的属性赋值（注入）"></a>如何给Bean的属性赋值（注入）</h1><ol>
<li><p>通过构造方法设置值</p>
</li>
<li><p>设置注入（通过set方法）</p>
<ol>
<li><p>如果属性是基本数据类型或String等简单类型</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"peo"</span> <span class="attr">class</span>=<span class="string">"com.bjsxt.pojo.People"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">value</span>=<span class="string">"222"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"张三"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>等效于</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"peo"</span> <span class="attr">class</span>=<span class="string">"com.bjsxt.pojo.People"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"id"</span> &gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">value</span>&gt;</span>222<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> &gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">value</span>&gt;</span>张三<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
<ol start="2">
<li><p>如果属性是 <code>set&lt;?&gt;</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sets"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>4<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol start="3">
<li><p>如果属性是 <code>list&lt;?&gt;</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<pre><code>1. 如果list中就只有一个值

   <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"list"</span> <span class="attr">value</span>=<span class="string">"1"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</code></pre><ol start="4">
<li><p>如果属性是数组</p>
<ol>
<li>如果数组中只有一个值，可以通过value属性直接赋值</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"strs"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol start="5">
<li><p>如果属性是map</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"map"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"a"</span> <span class="attr">value</span>=<span class="string">"b"</span>&gt;</span>			</span><br><span class="line">				<span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"c"</span> <span class="attr">value</span>=<span class="string">"d"</span>&gt;</span>			</span><br><span class="line">				<span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol start="6">
<li><p>如果属性是Properties类型</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"demo"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"key"</span>&gt;</span>value<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"key1"</span>&gt;</span>value1<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="DI"><a href="#DI" class="headerlink" title="DI"></a>DI</h1><ol>
<li><p>DI：中文名称：依赖注入</p>
</li>
<li><p>英文名称（<strong>Dependency Injection</strong>）</p>
</li>
<li><p>DI是什么？</p>
<ol>
<li>DI和IoC是一样的，当一个类A中需要依赖另一个类B对象时，把B赋值给A的过程就叫做依赖注入</li>
<li>代码体现</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"peo"</span> <span class="attr">class</span>=<span class="string">"com.bjsxt.pojo.People"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"desk"</span> <span class="attr">ref</span>=<span class="string">"desk"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"desk"</span> <span class="attr">class</span>=<span class="string">"com.bjsxt.pojo.Desk"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">value</span>=<span class="string">"1"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"price"</span> <span class="attr">value</span>=<span class="string">"12"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="使用Spring简化MyBatis"><a href="#使用Spring简化MyBatis" class="headerlink" title="使用Spring简化MyBatis"></a>使用Spring简化MyBatis</h1><ol>
<li><p>导入mybatis所有jar和spring基本包，spring-jdbc，spring-tx，spring-aop，mybatis-spring整合包等</p>
</li>
<li><p>编写spring配置文件applicationContext.xml编写代码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 数据源封装类,数据源:获取数据库连接 spring-jdbc.jar中  --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"com.mysql.cj.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/first?serverTimezone=GMT%2B8"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"123"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 创建sqlSessionFactory对象 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"factory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 数据库连接信息来源于dataSource --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 扫描器,相当于mybatis.xml中mapper下package标签，扫描 com.bjsxt.mapper包后会给对象接口创建对象--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 要扫描哪个包 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"com.bjsxt.mapper"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 和factory产生关系 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">ref</span>=<span class="string">"factory"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 由spring管理service实现类 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"airportService"</span> <span class="attr">class</span>=<span class="string">"com.bjsxt.service.impl.AirportServiceImpl"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"airportMapper"</span> <span class="attr">ref</span>=<span class="string">"airportMapper"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol start="3">
<li><p>正常编写pojo</p>
</li>
<li><p>编写mapper包下时必须使用接口绑定方案或注解方案（必须有接口）</p>
</li>
<li><p>正常编写service接口和实现类，需要在service实现类中声明Mapper接口对象，并生成get/set方法</p>
</li>
<li><p>spring无法管理servlet</p>
</li>
</ol>
<h1 id="AOP"><a href="#AOP" class="headerlink" title="AOP"></a>AOP</h1><ol>
<li>AOP中文名称：面向切面编程</li>
<li>英文名称：Aspect Oriented Programming</li>
<li>正常程序执行流程都是纵向执行流程<ol>
<li>面向切面编程在原有纵向执行流程中添加横切面</li>
<li>面向切面编程不需要修改原有程序代码(体现出程序高扩展性) <ol>
<li>高扩展性</li>
<li>原有功能相当于释放了部分逻辑，让职责更加明确</li>
</ol>
</li>
</ol>
</li>
<li>面向切面编程是什么？<ol>
<li>在程序原有纵 向执行流程中，针对某一个或某一些方法添加通知，形成横切面过程就叫做面向切面编程</li>
</ol>
</li>
<li>常用概念<ol>
<li>原有功能：切点，pointcut</li>
<li>前置通知：在切点之前执行的功能，before  advice</li>
<li>后置通知：在切点之后执行的功能，after  advice</li>
<li>如果切点执行过程中出现异常，会触发异常通知，throw advice</li>
<li>所有功能总称叫做切面</li>
<li>织入：把切面嵌入到原有功能的过程叫做织入</li>
</ol>
</li>
<li>spring提供了2种AOP实现方式<ol>
<li>Schema-based<ol>
<li>每个通知都需要实现接口或类</li>
<li>配置spring配置文件时在 <code>&lt;aop:config&gt;</code>配置</li>
</ol>
</li>
<li>AspectJ<pre><code>1. 每个通知不需要实现接口或类
</code></pre><ol start="2">
<li>配置spring配置文件是在 <code>&lt;aop:config&gt;</code>的子标签 <code>&lt;aop:aspect&gt;</code>中配置</li>
</ol>
</li>
</ol>
</li>
</ol>
<h1 id="Schema-based实现步骤"><a href="#Schema-based实现步骤" class="headerlink" title="Schema-based实现步骤"></a>Schema-based实现步骤</h1><ol>
<li><p>导入jar包</p>
<img src="/2019/09/14/Spring框架学习/aop需要的jar.png" title="This is an image">
</li>
<li><p>新建通知类</p>
<ol>
<li>新建前置通知类<ol>
<li>arg0：切点方法对象Method对象</li>
<li>arg1：切点方法参数</li>
<li>arg2：切点在哪个对象中</li>
</ol>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBeforeAdvice</span> <span class="keyword">implements</span> <span class="title">MethodBeforeAdvice</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line"> 	<span class="meta">@Override</span></span><br><span class="line"> 	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">(Method arg0, Object[] arg1, Object arg2)</span> <span class="keyword">throws</span> Throwable   </span>&#123;</span><br><span class="line"> 		System.out.println(<span class="string">"执行前置通知"</span>);	</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>新建后置通知类<ol>
<li>arg0：切点方法返回值</li>
<li>arg1：切点方法对象</li>
<li>arg2：切点方法参数</li>
<li>arg3：切点方法所在类的对象</li>
</ol>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAfterAdvice</span> <span class="keyword">implements</span> <span class="title">AfterReturningAdvice</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterReturning</span><span class="params">(Object arg0, Method arg1, Object[] arg2, Object arg3)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"执行后置通知"</span>);	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置spring配置文件</p>
<ol>
<li><p>引入aop命名空间：xmlns:aop=”<a href="http://www.springframework.org/schema/aop&quot;" target="_blank" rel="noopener">http://www.springframework.org/schema/aop&quot;</a></p>
<p>加上<a href="http://www.springframework.org/schema/aop" target="_blank" rel="noopener">http://www.springframework.org/schema/aop</a></p>
<pre><code>http://www.springframework.org/schema/aop/spring-aop.xsd
</code></pre></li>
<li><p>配置通知类的 <code>&lt;bean&gt;</code></p>
</li>
<li>配置切面</li>
<li><code>*</code>通配符，匹配任意方法名，任意类名，任意一级包名</li>
<li>如果需要匹配任意方法参数  （..）</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop/spring-aop.xsd"</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="comment">&lt;!-- 配置通知类对象，在切面中引入 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"mybefore"</span> <span class="attr">class</span>=<span class="string">"com.bjsxt.advice.MyBeforeAdvice"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"myafter"</span> <span class="attr">class</span>=<span class="string">"com.bjsxt.advice.MyAfterAdvice"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">   <span class="comment">&lt;!-- 配置切点 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">   	<span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">"execution(* com.bjsxt.test.Demo.demo2())"</span> <span class="attr">id</span>=<span class="string">"mypoint"</span>/&gt;</span></span><br><span class="line">   	<span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"mybefore"</span> <span class="attr">pointcut-ref</span>=<span class="string">"mypoint"</span>/&gt;</span></span><br><span class="line">   	<span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"myafter"</span> <span class="attr">pointcut-ref</span>=<span class="string">"mypoint"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">   <span class="comment">&lt;!-- 配置Demo类，测试使用 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"demo"</span> <span class="attr">class</span>=<span class="string">"com.bjsxt.test.Demo"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>编写测试代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		ApplicationContext ac=<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"applicationContext.xml"</span>);</span><br><span class="line">		Demo demo=ac.getBean(<span class="string">"demo"</span>,Demo.class);</span><br><span class="line">		demo.demo1();</span><br><span class="line">	    demo.demo2();</span><br><span class="line">	    demo.demo3();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行结果</p>
<img src="/2019/09/14/Spring框架学习/aop运行结果.png" title="This is an image">
</li>
</ol>
<h1 id="配置异常通知的步骤-AspectJ方式"><a href="#配置异常通知的步骤-AspectJ方式" class="headerlink" title="配置异常通知的步骤(AspectJ方式)"></a>配置异常通知的步骤(AspectJ方式)</h1><ol>
<li><p>只有当切点报异常才能触发异常通知</p>
</li>
<li><p>在spring中有AspectJ方式提供了异常通知的方法</p>
<ol>
<li>如果希望通过schema-based实现，需要按照特定的要求自己编写方法</li>
</ol>
</li>
<li><p>实现步骤：</p>
<ol>
<li><p>新建类，在类中写任意名称的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyThrowAdvice</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myexception</span><span class="params">(Exception e)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"执行异常通知,异常message："</span>+e.getMessage());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在spring配置文件中配置</p>
<ol>
<li><code>&lt;aop:aspect</code>&gt;的ref属性表示：方法在哪个类中</li>
<li><code>&lt;aop:xxxx/&gt;</code>表示什么通知，例如 <code>&lt;aop:after-throwing&gt;</code>表示异常通知</li>
<li>method：当触发这个通知时，调用哪个方法</li>
<li>其中throwing：异常对象名，必须和通知中方法参数名相同（可以不在通知中声明异常对象）</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"demo"</span> <span class="attr">class</span>=<span class="string">"com.bjsxt.test.Demo"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"mythrow"</span> <span class="attr">class</span>=<span class="string">"com.bjsxt.advice.MyThrowAdvice"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">   <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">   		<span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">"mythrow"</span>&gt;</span></span><br><span class="line">   			<span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">"execution(* com.bjsxt.test.Demo.demo1())"</span> <span class="attr">id</span>=<span class="string">"mypoint"</span>/&gt;</span></span><br><span class="line">   			<span class="tag">&lt;<span class="name">aop:after-throwing</span> <span class="attr">method</span>=<span class="string">"myexception"</span> <span class="attr">pointcut-ref</span>=<span class="string">"mypoint"</span> <span class="attr">throwing</span>=<span class="string">"e"</span>/&gt;</span></span><br><span class="line">  	 	<span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
<h1 id="异常通知（Schema-based方式）"><a href="#异常通知（Schema-based方式）" class="headerlink" title="异常通知（Schema-based方式）"></a>异常通知（Schema-based方式）</h1><ol>
<li><p>新建一个类实现throwsAdvice接口</p>
<ol>
<li><p>必须自己写方法，且必须叫afterThrowing</p>
</li>
<li><p>有两种参数方式，必须1个或4个</p>
</li>
<li><p>异常类型要与切点报的异常类型一致</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyThrow</span> <span class="keyword">implements</span> <span class="title">ThrowsAdvice</span> </span>&#123;</span><br><span class="line">	 <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterThrowing</span><span class="params">(Exception ex)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">	       System.out.println(<span class="string">"执行异常通知-schema-based方式"</span>);</span><br><span class="line">	    &#125;</span><br><span class="line">	 <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterThrowing</span><span class="params">(Method m, Object[] args, Object target, Exception ex)</span> </span>&#123;</span><br><span class="line">	       System.out.println(<span class="string">"执行异常通知"</span>);</span><br><span class="line">	    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
<ol start="2">
<li><p>在ApplicationContext.xml配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"demo"</span> <span class="attr">class</span>=<span class="string">"com.bjsxt.test.Demo"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"mythrow"</span> <span class="attr">class</span>=<span class="string">"com.bjsxt.advice.MyThrow"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span>     </span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">"execution(* com.bjsxt.test.Demo.demo1())"</span> <span class="attr">id</span>=<span class="string">"mypoint"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"mythrow"</span> <span class="attr">pointcut-ref</span>=<span class="string">"mypoint"</span>/&gt;</span>	</span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="环绕通知-Schema-based方式"><a href="#环绕通知-Schema-based方式" class="headerlink" title="环绕通知(Schema-based方式)"></a>环绕通知(Schema-based方式)</h1><ol>
<li><p>把前置通知和后置通知都写到一个通知中组成环绕通知</p>
</li>
<li><p>实现步骤</p>
<ol>
<li><p>新建一个类，实现MethodInterceptor</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyArround</span> <span class="keyword">implements</span> <span class="title">MethodInterceptor</span></span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(MethodInvocation arg0)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"环绕-前置"</span>);</span><br><span class="line">		Object result = arg0.proceed();<span class="comment">//放行，调用切点方式</span></span><br><span class="line">		System.out.println(<span class="string">"环绕-后置"</span>);</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
<ol start="3">
<li><p>配置ApplicationContext.xml</p>
   <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"demo"</span> <span class="attr">class</span>=<span class="string">"com.bjsxt.test.Demo"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"myarround"</span> <span class="attr">class</span>=<span class="string">"com.bjsxt.advice.MyArround"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">"execution(* com.bjsxt.test.Demo.demo1())"</span> <span class="attr">id</span>=<span class="string">"mypoint"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"myarround"</span> <span class="attr">pointcut-ref</span>=<span class="string">"mypoint"</span>/&gt;</span>	</span><br><span class="line">	<span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="使用AspectJ方式实现"><a href="#使用AspectJ方式实现" class="headerlink" title="使用AspectJ方式实现"></a>使用AspectJ方式实现</h1><ol>
<li><p>新建一个类，不用实现</p>
<ol>
<li><p>类中方法名任意</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAdvice</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mybefore</span><span class="params">(String name1,<span class="keyword">int</span> age1)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"前置"</span>+name1+<span class="string">"   "</span>+age1);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mybefore1</span><span class="params">(String name1)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"前置"</span>+name1);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myaftering</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"后置2"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myafter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"后置1"</span>);</span><br><span class="line">	&#125;	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mythrow</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"异常"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">myarround</span><span class="params">(ProceedingJoinPoint p)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"执行环绕"</span>);</span><br><span class="line">		System.out.println(<span class="string">"环绕-前置"</span>);</span><br><span class="line">		Object result = p.proceed();</span><br><span class="line">		System.out.println(<span class="string">"环绕-后置"</span>);</span><br><span class="line">		<span class="keyword">return</span> result;		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
<ol start="2">
<li><p>配置spring配置文件</p>
<ol>
<li><code>&lt;aop:after/&gt;</code>后置通知，是否出现异常都执行</li>
<li><code>&lt;aop:after-returning/&gt;</code>后置通知，只有当切点正确执行时执行</li>
<li><code>&lt;aop:after/&gt;</code>和<code>&lt;aop:after-returning/&gt;</code>和 <code>&lt;aop:after-throwing/&gt;</code>执行顺序和配置顺序有关</li>
<li>ececution括号不能包括上args</li>
<li>中间使用and不能使用&amp;&amp;，由spring把and解析成&amp;&amp;</li>
<li>args（名称）：名称是自定义的，顺序和demo1（参数，参数）对应</li>
<li><p><code>&lt;aop:before/&gt;</code>arg-names=”名称”，名称来源于expression=“ ”中args()，名称必须一致</p>
<ol>
<li>args()有几个参数，arg-names里面必须有几个参数</li>
<li>arg-names=“ ”里面名称必须和通知方法参数名对应</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"demo"</span> <span class="attr">class</span>=<span class="string">"com.bjsxt.test.Demo"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"myadvice"</span> <span class="attr">class</span>=<span class="string">"com.bjsxt.advice.MyAdvice"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">"myadvice"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">"execution(* com.bjsxt.test.Demo.demo1(String,int)) and args(name1,age1)"</span> <span class="attr">id</span>=<span class="string">"mypoint"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">"execution(* com.bjsxt.test.Demo.demo1(String)) and args(name1)"</span> <span class="attr">id</span>=<span class="string">"mypoint1"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">"mybefore"</span> <span class="attr">pointcut-ref</span>=<span class="string">"mypoint"</span> <span class="attr">arg-names</span>=<span class="string">"name1,age1"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">"mybefore1"</span> <span class="attr">pointcut-ref</span>=<span class="string">"mypoint1"</span> <span class="attr">arg-names</span>=<span class="string">"name1"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
<h1 id="使用注解-基于Aspect"><a href="#使用注解-基于Aspect" class="headerlink" title="使用注解(基于Aspect)"></a>使用注解(基于Aspect)</h1><ol>
<li><p>spring不会自动去寻找注解，必须告诉spring哪些包下的类中可能有有注解</p>
<ol>
<li><p>引入命名空间：xmlns:context =”<a href="http://www.springframework.org/schema/context&quot;" target="_blank" rel="noopener">http://www.springframework.org/schema/context&quot;</a></p>
<p>在 xsi:schemaLocation加上<a href="http://www.springframework.org/schema/context" target="_blank" rel="noopener">http://www.springframework.org/schema/context</a><br>和<a href="http://www.springframework.org/schema/context/spring-context.xsd" target="_blank" rel="noopener">http://www.springframework.org/schema/context/spring-context.xsd</a></p>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.bjsxt.advice"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol start="2">
<li><p>@Component</p>
<ol>
<li>相当于 <code>&lt;bean/&gt;</code></li>
<li>如果没有参数，把类名首字母变小写，相当于 <code>&lt;bean id=&quot;&quot;/&gt;</code></li>
<li>@Component(“自定义名称”)</li>
</ol>
</li>
<li><p>实现步骤：</p>
<ol>
<li><p>在spring配置文件中设置注解在哪些包中</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.bjsxt.advice,com.bjsxt.test"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在Demo类中添加@Component</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Pointcut</span>(<span class="string">"execution(* com.bjsxt.test.Demo.demo1())"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo1</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">		<span class="comment">//int i=5/0;</span></span><br><span class="line">		System.out.println(<span class="string">"demo1"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在方法上添加@Pointcut(“execution(* com.bjsxt.test.Demo.demo1())”)定义切点</p>
</li>
<li><p>在通知类中配置</p>
<ol>
<li>@Component类被spring管理</li>
<li>@Aspect相当于 <code>&lt;aop:aspect/&gt;</code>表示通知方法在当前类中<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAdvice</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Before</span>(<span class="string">"com.bjsxt.test.Demo.demo1()"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mybefore</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"前置"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@After</span>(<span class="string">"com.bjsxt.test.Demo.demo1()"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myafter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"后置"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@AfterThrowing</span>(<span class="string">"com.bjsxt.test.Demo.demo1()"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mythrow</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"异常通知"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Around</span>(<span class="string">"com.bjsxt.test.Demo.demo1()"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">myarround</span><span class="params">(ProceedingJoinPoint p)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"环绕-前置"</span>);</span><br><span class="line">		Object result = p.proceed();</span><br><span class="line">		System.out.println(<span class="string">"环绕-后置"</span>);</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<p>​      </p>
<h1 id="代理设计模式"><a href="#代理设计模式" class="headerlink" title="代理设计模式"></a>代理设计模式</h1><ol>
<li>设计模式：前人总结的一套解决特定问题的代码</li>
<li>代理设计模式优点：<ol>
<li>保护真实对象</li>
<li>让真实对象职责更明确</li>
<li>扩展</li>
</ol>
</li>
<li>代理设计模式<ol>
<li>真实对象(老总)</li>
<li>代理对象(秘书)</li>
<li>抽象(抽象功能)，小目标</li>
</ol>
</li>
<li>静态代理设计模式<ol>
<li>由代理对象代理所有真实对象的功能</li>
<li>自己编写代理类</li>
<li>每个代理的功能需要单独编写</li>
<li>静态代理设计模式的缺点：<ol>
<li>当代理功能比较多时，代理类中方法需要写很多</li>
</ol>
</li>
</ol>
</li>
<li>动态代理<ol>
<li>为了解决静态代理频繁编写代理功能缺点</li>
<li>分类：<ol>
<li>JDK提供的</li>
<li>cglib动态代理</li>
</ol>
</li>
</ol>
</li>
</ol>
<h1 id="JDK动态代理"><a href="#JDK动态代理" class="headerlink" title="JDK动态代理"></a>JDK动态代理</h1><ol>
<li>和cglib动态代理对比<ol>
<li>优点：jdk自带，不需要额外导入jar</li>
<li>缺点：<ol>
<li>真实对象必须实现接口</li>
<li>利用反射机制，效率不高</li>
</ol>
</li>
</ol>
</li>
<li>使用JDK动态代理时可能出现下面异常<ol>
<li>出现原因：希望把接口对象转换为具体真实对象</li>
</ol>
</li>
</ol>
<h1 id="cglib动态代理"><a href="#cglib动态代理" class="headerlink" title="cglib动态代理"></a>cglib动态代理</h1><ol>
<li><p>cglib优点：基于字节码，生成真实对象的子类，运行效率高于JDK动态代理</p>
</li>
<li><p>不需要实现接口</p>
</li>
<li><p>cglib缺点：非JDK功能，需要额外导入jar包</p>
</li>
<li><p>使用spring  aop时，只要出现proxy和真实对象转换异常</p>
<ol>
<li>设置为true：使用cglib</li>
<li><p>设置为false：使用jdk(默认值)</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span> <span class="attr">proxy-target-class</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:aspectj-autoproxy</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
<h1 id="自动注入"><a href="#自动注入" class="headerlink" title="自动注入"></a>自动注入</h1><ol>
<li>在spring配置文件中对象名和ref=”id”的id名相同时使用自动注入，可以不配置 <code>&lt;property/&gt;</code></li>
<li>两种配置方法<ol>
<li>在 <code>&lt;bean&gt;</code>中通过autowire=””配置，只对这个<code>&lt;bean&gt;</code>生效</li>
<li>在<code>&lt;beans&gt;</code>中通过default-autowire=””配置，表示当前文件中所有 <code>&lt;bean&gt;</code>都是全局配置内容</li>
</ol>
</li>
<li>autowire=””可取值<ol>
<li>default：默认值，根据全局default-autowire=””值，默认全局和局部都没有配置情况下，相当于no</li>
<li>no：不自动注入</li>
<li>byName：通过名称自动注入，在spring容器中找类的id</li>
<li>byType：根据类型注入，spring容器中不可以出现两个相同类型的<code>&lt;bean&gt;</code></li>
<li>constructor:根据构造方法注入<ol>
<li>提供对应参数的构造方法(构造方法参数中包含注入对应那个)<ol start="2">
<li>底层使用byName，构造方法参数名和其他<code>&lt;bean&gt;</code>的id相同</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<h1 id="spring中加载properties文件"><a href="#spring中加载properties文件" class="headerlink" title="spring中加载properties文件"></a>spring中加载properties文件</h1><ol>
<li><p>在src下新建xxx.peoperties文件</p>
</li>
<li><p>在spring配置文件中先引入xmlns:context，在下面添加</p>
<ol>
<li>如果需要记载多个配置文件，逗号分隔</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:db.properties,classpath:second.properties"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>添加了属性文件记载，并在<code>&lt;beans&gt;</code>中开启自动注入，注意的地方</p>
<ol>
<li>SqlSessionFactoryBean的id不能叫做sqlSessionFactory</li>
<li>修改</li>
<li>把原来通过ref引用替换成value赋值，自动注入只能影响ref，不会影响value赋值</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"com.bjsxt.mapper"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> 		<span class="comment">&lt;!-- &lt;property name="sqlSessionFactory" ref="factory"&gt;&lt;/property&gt; --&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlSessionFactoryBeanName"</span> <span class="attr">value</span>=<span class="string">"factory"</span> &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在spring管理的类中通过@value(“${key}”)取出properties中内容</p>
<ol>
<li>添加注解扫描</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.bjsxt.service.impl"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li><p>在类中添加</p>
<ol>
<li><p>key和变量名可以不相同</p>
</li>
<li><p>变量类型任意，只有保证key对应的value能转换成这个类型就可以</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Value</span>(<span class="string">"$&#123;my.demo&#125;"</span>)</span><br><span class="line"><span class="keyword">private</span> String test;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<h1 id="scope属性"><a href="#scope属性" class="headerlink" title="scope属性"></a>scope属性</h1><ol>
<li><code>&lt;bean&gt;</code>的属性<ol>
<li>作用：控制对象有效范围(单例，多例等)</li>
</ol>
</li>
<li><code>&lt;bean/&gt;</code>标签对应的对象默认是单例的<ol>
<li>无论获取多少次，都是同一个对象</li>
<li>scope可取值<ol>
<li>singleton：默认值，单例</li>
<li>prototype：多例，每次获取重新实例化</li>
<li>request：每次请求重新实例化</li>
<li>session：每个会话对象内，对象是单例的</li>
<li>application：在application对象内是单例</li>
<li>global session：spring推出的一个对象，依赖于spring-webmvc-portlet，类似于session</li>
</ol>
</li>
</ol>
</li>
</ol>
<h1 id="单例设计模式"><a href="#单例设计模式" class="headerlink" title="单例设计模式"></a>单例设计模式</h1><ol>
<li><p>作用：在应用程序有保证最多只能有一个实例</p>
</li>
<li><p>好处：</p>
<ol>
<li><p>提升运行效率</p>
</li>
<li><p>实现数据共享，案例：application对象</p>
</li>
</ol>
</li>
</ol>
<ol start="3">
<li><p>懒汉式</p>
<ol>
<li><p>对象只有被调用时才去创建</p>
</li>
<li><p>示例代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">	<span class="comment">//由于对象需要被静态方法调用，把方法设置为static</span></span><br><span class="line">	<span class="comment">//由于对象是static，必须设置访问权限修饰符为private，如果是public可以直接调用对象，不执行访问入口</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Singleton singleton;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * 方法名和类名相同</span></span><br><span class="line"><span class="comment">	 * 无返回值</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * 其他类不能实例化这个类对象</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * 对外提供访问入口</span></span><br><span class="line"><span class="comment">	 * */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * 实例方法，实例方法必须通过对象调用</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * 设置方法为静态方法</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">//添加逻辑，如果实例化过，直接返回</span></span><br><span class="line">		<span class="keyword">if</span>(singleton==<span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="comment">//多线程访问下，可能出现if同时成立的情况，添加锁</span></span><br><span class="line">			<span class="keyword">synchronized</span> (Singleton.class) &#123;</span><br><span class="line">				<span class="comment">//双重验证</span></span><br><span class="line">				<span class="keyword">if</span>(singleton==<span class="keyword">null</span>) &#123;</span><br><span class="line">					singleton=<span class="keyword">new</span> Singleton();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> singleton;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>由于添加了锁，所以导致效率低</p>
</li>
</ol>
</li>
<li><p>饿汉式</p>
<ol>
<li><p>解决了懒汉式中多线程访问可能出现同一个对象和效率低问题</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Singleton singleton=<span class="keyword">new</span> Singleton();</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> singleton;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
<h1 id="声明式事务"><a href="#声明式事务" class="headerlink" title="声明式事务"></a>声明式事务</h1><ol>
<li><p>编程式事务：</p>
<ol>
<li><p>由程序员编程事务控制代码</p>
<ol start="2">
<li>OpenSessionInView编程式事务</li>
</ol>
</li>
</ol>
</li>
<li><p>声明式事务：</p>
<pre><code>1. 事务控制代码已经由spring写好，程序员只需要声明出哪些地方需要进行事务控制和如何进行事务控制
</code></pre></li>
<li><p>声明式事务都是针对ServiceImpl类下方法的</p>
</li>
<li><p>事务管理器基于通知(advice)的</p>
</li>
<li><p>在spring配置文件中配置声明式事务</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span> =<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx/spring-tx.xsd"</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- 数据源封装类,数据源:获取数据库连接 spring-jdbc.jar中  --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"com.mysql.cj.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/first?serverTimezone=GMT%2B8"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"123"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 创建sqlSessionFactory对象 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"factory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 数据库连接信息来源于dataSource --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 扫描器,相当于mybatis.xml中mapper下package标签，扫描 com.bjsxt.mapper包后会给对象接口创建对象--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 要扫描哪个包 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"com.bjsxt.mapper"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 和factory产生关系 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">ref</span>=<span class="string">"factory"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"txManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">        	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 配置声明事务 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"txAdvice"</span> <span class="attr">transaction-manager</span>=<span class="string">"txManager"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 哪些方法需要有事务控制 --&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"insert"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span>       </span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 切点范围设置大一些 --&gt;</span></span><br><span class="line">        	<span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">"execution(* com.bjsxt.service.impl.*.*(..))"</span> <span class="attr">id</span>=<span class="string">"mypoint"</span>/&gt;</span></span><br><span class="line">        	<span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"txAdvice"</span> <span class="attr">pointcut-ref</span>=<span class="string">"mypoint"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="声明式事务中属性解释"><a href="#声明式事务中属性解释" class="headerlink" title="声明式事务中属性解释"></a>声明式事务中属性解释</h1><ol>
<li>name=””哪些方法需要有事务控制<ol>
<li>支持*通配符</li>
</ol>
</li>
<li>readonly=”boolean”是否是只读事务<ol>
<li>如果为true，告诉数据库此事务为只读事务，数据库优化，会对性能有一点提升，所以只要是查询的方法，建议使用此属性</li>
<li>如果为false(默认值)，事务需要提交的事务，建议新增，删除，修改</li>
</ol>
</li>
<li>propagation：控制事务传播行为<ol>
<li>当一个具体事务控制的方法被另一个有事务控制的方法调用后，需要如何管理事务(新建事务？在事务中执行？把事务挂起？报异常？)</li>
<li>REQUIRED(默认值)：如果当前有事务，就在事务中执行；如果当前没有事务，新建一个事</li>
<li>SUPPORTS：如果当前有事务，就在事务中执行；如果当前没有事务，就在非事务状态下执行</li>
<li>MANDATORY：必须在事务内部执行，如果当前有事务，就在事务中执行；如果没有事务，报错</li>
<li>REQUIRES_NEW：必须在事务中执行，如果当前没有事务，新建一个事务；如果当前有事务，把当前事务挂起</li>
<li>NOT_SUPPORTED：必须在非事务状态下执行，如果当前没有事务，正常执行；如果当前有事务，把当前事务挂起</li>
<li>NEVER：必须在非事务状态下执行，如果当前没有事务，正常执行；如果当前有事务，报错</li>
<li>NESTED：必须在事务状态下执行。如果没有事务，新建事务；如果当前有事务，创建一个嵌套事务</li>
</ol>
</li>
<li>isolation=””事务隔离级别，在多线程或并发访问下如何保证访问到的数据具有完整性的</li>
<li>脏读：<pre><code>1. 一个事务(A)读取到另一个事务(B)中未提交的数据，另一个事务中数据可能进行了改变，此时A事务读取的数据就可能和数据库中数据不一致，此时认为数据是脏数据，读脏数据的过程就叫做脏读
</code></pre></li>
<li>不可重复读：<pre><code>1. 主要针对的是某行数据(或行中某列)
 2. 主要针对的操作是修改操作
 3. 两次读取在同一个事务内
 4. 当事务A第一次读取事务后， 事务B对事务A读取的数据进行修改，事务A中再次读取的数据和之前读取的数据不一致，过程不可重复读
</code></pre></li>
<li>幻读：<pre><code>1. 主要针对的操作是新增或删除
 2. 两次事务的结果
 3. 事务A按照特定条件查询出结果，事务B新增了一条符合条件的数据，事务A中查询的数据和数据库的数据不一致，事务A好像出现了幻觉，这种情况称为幻读
</code></pre></li>
<li>DEFAULT：默认值，由底层数据库自行判断应该使用什么隔离级别</li>
<li>READ_UNCOMMITTED：可以读取未提交数据，可能出现脏读，不可重复读，幻读<pre><code>1. 效率最高
</code></pre></li>
<li>READ_COMMITTED：只能读取其他事务已提交数据，可以防止脏读，可能出现不可重复读和幻读</li>
<li>REPEATABLE_READ：读取的数据会被添加锁，防止其他事务修改此数据，可以防止不可重复读和脏读，可能出现幻读</li>
<li>SERIALIZABLE：排队操作，对整个表添加锁，一个事务在操作数据时，另一个事务等待，事务操作完成后才能操作这个表<pre><code>1. 最安全的
2. 效率最低的
</code></pre></li>
<li>rollback-for=”异常类型全限定路径”<pre><code>1. 当出现什么异常时需要进行回滚
 2. 建议：给定该属性值
 3. 手动抛出异常一定要给该属性值
</code></pre></li>
<li>no-rollback-for=””<pre><code>1. 当出现什么异常时不回滚事务
</code></pre></li>
</ol>
<h1 id="spring中常用注解"><a href="#spring中常用注解" class="headerlink" title="spring中常用注解"></a>spring中常用注解</h1><ol>
<li>@Component创建类对象，相当于配置 <code>&lt;bean/&gt;</code></li>
<li>@Service与@Component功能相同，写在ServiceImpl类上</li>
<li>@Repository与@Component功能相同，写在数据访问层类上</li>
<li>@Controller与@Component相同，写在控制器类上</li>
<li>@Resource(不需要写对象的get/set方法)<ol>
<li>java中的注解</li>
<li>默认按照byName注入，如果没有名称对象，按照byType注入</li>
<li>建议把对象名称和spring容器中对象名相同</li>
</ol>
</li>
<li>@Autowired(不需要写对象的get/set方法)<ol>
<li>spring的注解</li>
<li>默认按照byType注入</li>
</ol>
</li>
<li>@Value()获取peoperties文件中内容</li>
<li>@Pointcut()定义切点</li>
<li>@Aspect()定义切面类</li>
<li>@Before()前置通知</li>
<li>@After()后置通知</li>
<li>@AfterReturning后置通知，必须切点正确执行</li>
<li>@AfterThrowing异常通知</li>
<li>@Arround环绕通知</li>
</ol>
<h1 id="Ajax"><a href="#Ajax" class="headerlink" title="Ajax"></a>Ajax</h1><ol>
<li><p>标准请求响应时浏览器的动作(同步操作)</p>
<ol>
<li>浏览器请求什么资源，跟随显示什么资源</li>
</ol>
</li>
<li><p>ajax异步请求</p>
<ol>
<li>局部刷新，通过异步请求，请求到服务器资源数据后，通过脚本修改页面中部分内容</li>
</ol>
</li>
<li><p>ajax由javascript推出</p>
</li>
</ol>
<ol start="4">
<li><p>由jQuery对js中ajax代码进行的封装，达到使用方便地效果</p>
<ol start="5">
<li><p>jQuery中ajax分类</p>
<ol>
<li><p>第一层：$.ajax({属性名：值，属性名：值})</p>
<ol>
<li>是jQuery中功能最全的，代码写起来相对最麻烦</li>
<li><p>示例代码</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">$(function()&#123;</span></span><br><span class="line"><span class="undefined">	/*</span></span><br><span class="line"><span class="undefined">	url:请求服务器地址</span></span><br><span class="line"><span class="undefined">	data：请求参数</span></span><br><span class="line"><span class="undefined">	dataType：服务器返回数据的类型</span></span><br><span class="line"><span class="undefined">	error:请求出错执行的功能</span></span><br><span class="line"><span class="undefined">	success:请求成功执行的功能,function(data),data服务器返回的数据</span></span><br><span class="line"><span class="undefined">	type:请求方式</span></span><br><span class="line"><span class="undefined">	*/</span></span><br><span class="line"><span class="undefined">	$("a").click(function()&#123;</span></span><br><span class="line"><span class="undefined">		$.ajax(&#123;</span></span><br><span class="line"><span class="undefined">			url:'DemoServlet',</span></span><br><span class="line"><span class="undefined">			data:&#123;"name":"张三"&#125;,</span></span><br><span class="line"><span class="undefined">			dataType:'html',</span></span><br><span class="line"><span class="undefined">			error:function()&#123;</span></span><br><span class="line"><span class="undefined">				alert("请求出错。")</span></span><br><span class="line"><span class="undefined">			&#125;,</span></span><br><span class="line"><span class="undefined">			success:function(data)&#123;</span></span><br><span class="line"><span class="undefined">				alert("请求成功!"+data)</span></span><br><span class="line"><span class="undefined">			&#125;,</span></span><br><span class="line"><span class="undefined">			type:'POST'</span></span><br><span class="line"><span class="undefined">		&#125;);</span></span><br><span class="line"><span class="undefined">		return false;</span></span><br><span class="line"><span class="undefined">	&#125;)</span></span><br><span class="line"><span class="undefined">&#125;);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>第二层：简化$.ajax    </p>
<ol>
<li>$.get(url, <em>[data]</em>, <em>[callback]</em>, <em>[type]</em>)</li>
<li>$.post(url, <em>[data]</em>, <em>[callback]</em>, <em>[type]</em>)</li>
</ol>
</li>
<li><p>第三层：简化$.get()     </p>
<ol>
<li>$.getJSON(url, <em>[data]</em>, <em>[callback]</em>)，相当于设置$.get中dataType=”json”</li>
<li>$.getScript(url, <em>[callback]</em>)相当于设置$.get中dataType=”script”</li>
<li>如果服务器返回的数据是从表中取出来的，为了方便客户端操作返回的数据，服务器端返回的数据设置成json</li>
<li>客户端把json当作对象或数组操作</li>
</ol>
</li>
</ol>
</li>
<li><p>json：一种数据格式</p>
<ol>
<li>JsonObject：json对象，理解成java中对象<ol>
<li>{“key”：value，“key”：value}<ol start="2">
<li>JsonArray：json数组</li>
<li>[{“key”：value，“key”：value}，{“key”：value，“key”：value}]</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/27/MyBatis框架学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wangwei">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="二十一的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/08/27/MyBatis框架学习/" class="post-title-link" itemprop="url">MyBatis框架学习</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-08-27 16:29:45 / 修改时间：16:49:32" itemprop="dateCreated datePublished" datetime="2019-08-27T16:29:45+08:00">2019-08-27</time>
            

            
              

              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>框架是什么？</p>
<p>​    1.框架：软件的半成品，未解决问题制定的一套约束，在提供功能基础上进行扩充</p>
<p>​    2.框架中一些不能被封装的代码(变量)，需要使用框架新建一个xml文件，在文件中添加变量内容。</p>
<p>​      2.1需要建立特定位置和特定名称的配置文件</p>
<p>​      2.2需要使用xml解析技术和反射技术</p>
<p>​    3.常用概率</p>
<p>​      3.1类库：提供的类没有封装一定逻辑</p>
<p>​    举例：类库就是名言警句，写作文时引入名言警句</p>
<p>​      3.2框架：区别于类库，里面有一些约束</p>
<p>​    举例：框架是填空题</p>
<p>​    4.SSM框架：Spring、SpringMVC、Mybaits</p>
<h1 id="MyBatis简介"><a href="#MyBatis简介" class="headerlink" title="MyBatis简介"></a>MyBatis简介</h1><p>​    1.1Mybatis开源免费框架，原名叫iBatis，2010在Google code，2.13年迁移到github</p>
<p>​    1.2作用：数据访问层</p>
<p>​        1.2.1底层是对JDBC的封装</p>
<p>​    1.3mybatis优点之一：</p>
<p>​        1.3.1使用mybatis时不需要编写实现类，只需要写执行的sql命令</p>
<h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p>​    2.1导入jar包</p>
<p>​    mysql数据库包</p>
<p>​    asm：cglib依赖包</p>
<p>​    cglib：动态代理包</p>
<p>​    commons-logging：日志包</p>
<p>​    javassist：字节码解析包，也是cglib依赖包</p>
<p>​    log4j、log4j-core、log4j-api：日志包</p>
<p>​    mybatis：mybatis核心包</p>
<p>​    slf4j-api、slf4j-log4j：日志包</p>
<p>​    2.2在src下新建全局配置文件(编写JDBC四个变量)</p>
<p>​        2.2.1没有名称和地址要求</p>
<p>​        2.2.2在全局配置文件中引入DTD或schema(不导这些东西就没有提示)</p>
<p>​        2.2.3全局配置文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE configuration </span></span><br><span class="line"><span class="meta">PUBLIC "-//mybatis.org//DTD Config 3.0//EN" </span></span><br><span class="line"><span class="meta">"http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- default引用environment的id，当前使用的环境 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"default"</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 声明可以使用的环境 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"default"</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 使用原生JDBC事务 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>&gt;</span><span class="tag">&lt;/<span class="name">transactionManager</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"com.mysql.cj.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/first?serverTimezone=GMT%2B8"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"123"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/bjsxt/mapper/FlowerMapper.xml"</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="新建以mapper结尾的包，在包下新建：实体类名-Mapper-xml"><a href="#新建以mapper结尾的包，在包下新建：实体类名-Mapper-xml" class="headerlink" title="新建以mapper结尾的包，在包下新建：实体类名+Mapper.xml"></a>新建以mapper结尾的包，在包下新建：实体类名+Mapper.xml</h1><p>​    3.1文件作用：编写需要执行的SQL命令</p>
<p>​    3.2把xml文件理解成实现类</p>
<p>​    3.3xml文件内容</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE mapper </span></span><br><span class="line"><span class="meta">PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"</span></span><br><span class="line"><span class="meta">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- namespace:理解成实现类的全路径(包名+类名) --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"a.b"</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- id方法名</span></span><br><span class="line"><span class="comment">   parameterType:定义参数类型</span></span><br><span class="line"><span class="comment">   resultType:返回值类型</span></span><br><span class="line"><span class="comment">   </span></span><br><span class="line"><span class="comment">   如果方法返回值是list，在resultType中写list的泛型，因为mybatis对jdbc封装，一行一行读取数据</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selAll"</span> <span class="attr">resultType</span>=<span class="string">"com.bjsxt.pojo.Flower"</span>&gt;</span></span><br><span class="line">   select * from flower</span><br><span class="line">   <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>​    3.4.测试结果(只有在单独使用mybatis时使用，最好ssm整合时下面代码不需要编写)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">InputStream is = Resources.getResourceAsStream(<span class="string">"mybatis.xml"</span>);</span><br><span class="line">		<span class="comment">// 使用工厂设计模式</span></span><br><span class="line">		SqlSessionFactory factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">		<span class="comment">// 生成SqlSession</span></span><br><span class="line">		SqlSession session = factory.openSession();</span><br><span class="line">		List&lt;Flower&gt; list = session.selectList(<span class="string">"a.b.setAll"</span>);</span><br><span class="line">		<span class="keyword">for</span> (Flower flower : list) &#123;</span><br><span class="line">			System.out.println(flower.toString());</span><br><span class="line">		&#125;</span><br><span class="line">		session.close();</span><br></pre></td></tr></table></figure>
<h1 id="环境搭建详解"><a href="#环境搭建详解" class="headerlink" title="环境搭建详解"></a>环境搭建详解</h1><p>​    4.1全局配置文件内容</p>
<p>​        4.1.1 <code>&lt;transactionManager/&gt;</code> type属性可取值</p>
<p>​         1.JDBC，事务管理使用JDBC原生事务管理方式</p>
<p>​         2.MANAGER把事务管理转交给其他容器，原生JDBC事务setAutoMapping(false)</p>
<p>​        4.1.2 <code>&lt;dataSource/&gt;</code> type属性可取值</p>
<p>​         1.POOLED使用数据库连接池</p>
<p>​         2.UNPOOLED不使用数据库连接池，和直接使用JDBC一样</p>
<p>​         3.JNDI：java命名目录接口技术</p>
<p>​    </p>
<h1 id="数据库连接池"><a href="#数据库连接池" class="headerlink" title="数据库连接池"></a>数据库连接池</h1><p>​    5.1.在内存中开辟一块空间，存放多个数据库连接对象</p>
<p>​    5.2.JDBC Tomcat Pool，直接由tomcat产生数据库连接池</p>
<p>​    5.3.状态：active状态：当前连接对象被应用程序使用中</p>
<p>​            idle状态：空闲等待应用程序使用</p>
<p>​    5.4.使用数据库连接池的目的</p>
<p>​        1.在高频率访问数据库时，使用数据库连接池可以降低系统压力，提高程序运行效率(小型项目不适用数据库连接池)</p>
<p>​    5.5.实现JDBC tomcat pool的步骤</p>
<p>​        1.在web项目的META-INF中存放context.xml，在context.xml里面编写数据库连接池相关属性</p>
<p>​    配置数据库连接池代码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Context</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Resource</span></span></span><br><span class="line"><span class="tag">  <span class="attr">driverClassName</span>=<span class="string">"com.mysql.cj.jdbc.Driver"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">url</span>=<span class="string">"jdbc:mysql://localhost:3306/first?serverTimezone=GMT%2B8"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">username</span>=<span class="string">"root"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">password</span>=<span class="string">"123"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">maxActive</span>=<span class="string">"50"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">maxIdle</span>=<span class="string">"20"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">name</span>=<span class="string">"test"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">auth</span>=<span class="string">"Container"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">maxWait</span>=<span class="string">"10000"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">type</span>=<span class="string">"javax.sql.DataSource"</span></span></span><br><span class="line"><span class="tag">   /&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">Context</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>​        2.把项目发布到tomcat中，数据库连接池产生</p>
<p>​    5.6.可以在java中使用JNDI获取数据连接池中对象</p>
<p>​        1.Context：上下文接口，context.xml文件对象类型</p>
<p>​        2.JNDI代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">         Context cxt=<span class="keyword">new</span> InitialContext();</span><br><span class="line">DataSource ds = (DataSource) cxt.lookup(<span class="string">"java:comp/env/test"</span>);</span><br><span class="line">Connection conn = ds.getConnection();</span><br></pre></td></tr></table></figure>
<p>​        3.当关闭连接对象时，把连接对象归还给数据库连接池，把状态改变成Idle</p>
<h1 id="三种查询方式"><a href="#三种查询方式" class="headerlink" title="三种查询方式"></a>三种查询方式</h1><p>​    6.1.selectList() 返回值为List&lt;resultType属性控制&gt;</p>
<p>​    适用于查询结果都需要遍历的需求</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Flower&gt; list = session.selectList(<span class="string">"a.b.selAll"</span>);</span><br><span class="line">		<span class="keyword">for</span> (Flower flower : list) &#123;</span><br><span class="line">			System.out.println(flower.toString());</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>
<p>​    6.2selectOne()，返回值Object</p>
<p>​    适用于返回结果只是变量或一行数据时</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> count = session.selectOne(<span class="string">"a.b.selById"</span>);<span class="comment">//返回值就是一个变量或一个对象值</span></span><br><span class="line">		System.out.println(count);</span><br></pre></td></tr></table></figure>
<p>​    6.3selectMap()，返回值Map</p>
<p>​    适用于需要在查询结果中通过某列的值取到这行数据的需求</p>
<p>​    Map&lt;key,resultType控制&gt;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;Object, Object&gt; map = session.selectMap(<span class="string">"a.b.c"</span>, <span class="string">"name"</span>);</span><br><span class="line">		System.out.println(map);</span><br></pre></td></tr></table></figure>
<h1 id="log4j"><a href="#log4j" class="headerlink" title="log4j"></a>log4j</h1><p>​    7.1由Apache推出的开源免费日志处理的类库</p>
<p>​    7.2为什么需要日志：</p>
<p>​        7.2.1在项目中编写System.out.println();输出到控制台，当项目发布到tomcat后，没有控制台(在命令行界面能看见)，不容易观察一些输出结果</p>
<p>​        7.2.2log4j作用，不仅能把内容输出到控制台，还能把内容输出到文件中。便于观察结果</p>
<p>​        7.2.3使用步骤</p>
<p>​        1.导入jar包</p>
<p>​        2.在src下新建log4j.properties(路径和名称都不允许改变)</p>
<p>​        3.conversionPattern：写表达式</p>
<p>​        4.log4j.appender.LOGFILE.File文件位置及名称(日志文件扩展名.log)</p>
<p>​        7.2.4log4j输出级别</p>
<p>​            1.fatal(致命错误)&gt;error(错误)&gt;warn(警告)&gt;info(普通信息)&gt;debug(调试信息)</p>
<p>​            2.在log4j.properties的第一行中控制输出级别</p>
<p>​        7.2.5log4j输出目的地</p>
<p>​        1.在第一行控制输出目的地</p>
<p>​        7.2.6pattern中几个常用表达式</p>
<p>​            1.%C   包名+类名</p>
<p>​            2.%d{YYYY-MM-dd  HH：mm：ss}    时间</p>
<p>​            3.%L    行号</p>
<p>​            4.%m   信息</p>
<p>​            5.%n     换行</p>
<h1 id="lt-setting-gt-标签"><a href="#lt-setting-gt-标签" class="headerlink" title="&lt;setting&gt; 标签"></a><code>&lt;setting&gt;</code> 标签</h1><p>​    1.在mybatis全局配置文件中通过 <code>&lt;setting&gt;</code>标签控制全局开关</p>
<p>​    2.在mybatis.xml中开启log4j，必须保证有log4j.jar和在src下有log4j.properties</p>
<p>​    在全局配置文件中加</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"logImpl"</span> <span class="attr">value</span>=<span class="string">"LOG4J"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>​    3.log4j中可以输出指定内容的日志(控制某个局部内容的级别)</p>
<p>​        1.命名级别(包级别)：a</p>
<p>​         <code>&lt;mapper&gt;</code>namespace属性中除了最后一个类名</p>
<p>​        例如：namespace=”com.bjsxt.mapper.PeopleMapper”其中包级别为com.bjsxt.mapper，需要在log4j.properties中</p>
<ul>
<li>​        先在总体级别调成ERROR，不输出无用信息</li>
<li>​        再设置某个指定位置级别为DEBUG</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">log4j.rootCategory=ERROR,CONSOLE,LOGFILE</span><br><span class="line"></span><br><span class="line">log4j.logger.a=DEBUG</span><br></pre></td></tr></table></figure>
<p>用ERROR，否则会输出许多没用信息</p>
<p>​        2.类级别:a.b</p>
<p>​            namespace属性值，namespace类名</p>
<p>​        3.方法级别:a.b.c</p>
<p>​            使用namespace属性值+标签id属性值</p>
<h1 id="parameterType属性"><a href="#parameterType属性" class="headerlink" title="parameterType属性"></a>parameterType属性</h1><p>​    9.1在XXXMapper.xml中 <code>&lt;select&gt; &lt;delete&gt;</code>等标签的parameterType可以控制参数类型</p>
<p>​    9.2SqlSession的selectList()和selectOne()的第二个参数和selectMap()的第三个参数都表示方法的参数</p>
<p>​        1.示例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">People p = session.selectOne(<span class="string">"a.b.selById"</span>,<span class="number">2</span>);</span><br><span class="line">	System.out.println(p);</span><br></pre></td></tr></table></figure>
<p>​        2.在Mapper.xml中可以通过#{}获取参数，从0开始</p>
<p>​            parameterType控制参数类型</p>
<p>​            #{}获取参数内容，其中可以使用索引，从0开始，#{0}表示第一个参数</p>
<p>​            也可以使用#{param1}表示第一个参数</p>
<p>​            如果只有一个参数(基本数据类型或String)，mybatis对#{}里面的内容没有要求，只写内容即可</p>
<p>​            如果参数时对象，写#{属性名}</p>
<p>​            如果参数是map，写成#{key}</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selById"</span> <span class="attr">resultType</span>=<span class="string">"com.bjsxt.pojo.People"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">	select * from people where id=#&#123;0&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>​        3.关于#{}和${}的区别</p>
<p>​        #{}获取参数的内容，支持索引获取，param1获取指定位置参数，并且SQL使用？占位符</p>
<p>​        ${}字符串拼接，不使用？占位符，默认找${内容}内容的get/set方法，如果写数字，就是一个数字</p>
<p>​        4.如果在xml文件中出现”&lt;”,”&gt;”,双引号等特殊字符时可以使用xml文件转义标签(xml自身的)</p>
<p>​         <code>&lt;![CDATA[内容]]&gt;</code></p>
<p>​        5.mybatis中实现mysql分页写法</p>
<p>​        ?不允许在关键字前后进行数学运算，需要在代码中计算完成后传递到mapper.xml中</p>
<p>​        在java代码中计算</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> pageSize=<span class="number">2</span>;</span><br><span class="line"><span class="keyword">int</span> pageNumber=<span class="number">2</span>;</span><br><span class="line">Map&lt;String,Object&gt;map=<span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"><span class="comment">//pageSize表示显示几个，pageNumber表示第几页</span></span><br><span class="line">map.put(<span class="string">"pageSize"</span>, pageSize);</span><br><span class="line">map.put(<span class="string">"pageStart"</span>, pageSize*(pageNumber-<span class="number">1</span>));	</span><br><span class="line">List&lt;People&gt; p = session.selectList(<span class="string">"a.b.page"</span>,map);</span><br></pre></td></tr></table></figure>
<p>​            在mapper.xml中代码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"page"</span> <span class="attr">resultType</span>=<span class="string">"com.bjsxt.pojo.People"</span> <span class="attr">parameterType</span>=<span class="string">"map"</span>&gt;</span></span><br><span class="line">	select * from people limit #&#123;pageStart&#125;,#&#123;pageSize&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="typeAliases别名"><a href="#typeAliases别名" class="headerlink" title="typeAliases别名"></a>typeAliases别名</h1><p>​    1.系统内置别名：把类型全小写</p>
<p>​    2.给某个类起别名，在全局配置文件mybatis.xml中，alias=“自定义”</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">"com.bjsxt.pojo.People"</span> <span class="attr">alias</span>=<span class="string">"peo"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>​    mapper.xml中peo引用People类</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"page"</span> <span class="attr">resultType</span>=<span class="string">"peo"</span> <span class="attr">parameterType</span>=<span class="string">"map"</span>&gt;</span></span><br><span class="line">select * from people limit #&#123;pageStart&#125;,#&#123;pageSize&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>​    3.直接给某个包下所有类取别名</p>
<p>​        3.1在mybatis.xml下配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.bjsxt.pojo"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>​    3.2在mapper.xml中通过类名引用</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"page"</span> <span class="attr">resultType</span>=<span class="string">"People"</span> <span class="attr">parameterType</span>=<span class="string">"map"</span>&gt;</span></span><br><span class="line">select * from people limit #&#123;pageStart&#125;,#&#123;pageSize&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="mybatis实现新增"><a href="#mybatis实现新增" class="headerlink" title="mybatis实现新增"></a>mybatis实现新增</h1><p>​    1.概率复习</p>
<p>​    1.1功能：从应用程序角度出发，软件具有哪些功能</p>
<p>​    1.2业务：完成功能时的逻辑，对应service中一个方法</p>
<p>​    1.3事务：从数据库角度出发，完成业务时需要执行的SQL集合统称一个事务</p>
<p>​        事务回滚：如果一个事务中某个SQL执行事务，希望回归到事务原点，保证数据库数据的完整性</p>
<p>​    2.在mybatis中默认是关闭了JDBC的自动提交功能</p>
<p>​        2.1每一个SqlSession默认都是不自动提交事务</p>
<p>​        2.2session.commit()提交事务</p>
<p>​        2.3openSession(true);自动提交setAutoCommit(true);</p>
<p>​    3.mybatis底层都是对JDBC的封装</p>
<p>​        3.1JDBC中executeUpdate()执行新增，删除，修改的SQL返回值int，表示受影响的行数</p>
<p>​        3.2mybatis中<code>&lt;insert&gt;&lt;delete&gt;&lt;update&gt;</code>标签没有resultType属性，认为返回值都是int</p>
<p>​    4.在openSession()时mybatis会创建SqlSession时同时创建一个Transaction(事务对象)，同时autoCommit都为false</p>
<p>​    4.1如果出现异常，应该session.rollback()回滚事务</p>
<h1 id="Mybatis接口绑定方案及多参数传递"><a href="#Mybatis接口绑定方案及多参数传递" class="headerlink" title="Mybatis接口绑定方案及多参数传递"></a>Mybatis接口绑定方案及多参数传递</h1><p>12.1.作用：实现创建一个接口后把mapper.xml由mybatis生成接口的实现类，通过调用接口对象就可以获取mapper.xml中编写的sql</p>
<p>12.2.后面mybatis和spring整合时使用的是这个方案</p>
<p>12.3.实现步骤</p>
<p>​    3.1创建一个接口</p>
<p>​        3.1.1接口包名和接口名与mapper.xml中 <code>&lt;mappers&gt;</code>namespcae相同</p>
<p>​        3.1.2接口中方法名和mapper.xml标签的id属性相同</p>
<p>​    3.2在mybatis.xml中使用 <code>&lt;package&gt;</code>进行扫描接口和mapper.xml</p>
<p>12.4.代码实现步骤：</p>
<p>​    4.1在mybatis.xml中 <code>&lt;mappers&gt;</code>下使用 <code>&lt;package&gt;</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.bjsxt.mapper"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>​    4.2在com.bjsxt.mapper下新建一个接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">LogMapper</span> </span>&#123;</span><br><span class="line">	<span class="function">List&lt;Log&gt; <span class="title">selAll</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​    4.3在com.bjsxt.mapper下新建一个LogMapper.xml </p>
<p>​        4.3.1namespace必须和接口全限定路径(包名+类名)一致</p>
<p>​        4.3.2id值必须和接口中方法名相同</p>
<p>​        4.3.3如果接口中方法为多个参数，可以省略parameterType</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.bjsxt.mapper.LogMapper"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selAll"</span> <span class="attr">resultType</span>=<span class="string">"log"</span>&gt;</span></span><br><span class="line">	select * from log</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>12.5.多参数实现方法</p>
<p>​    5.1在接口中声明方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">LogMapper</span> </span>&#123;</span><br><span class="line">	<span class="function">List&lt;Log&gt; <span class="title">selByAccInAccount</span><span class="params">(String accin,String accout)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​    5.2在mapper.xml中添加</p>
<p>​        5.2.1#{}中使用arg1、arg0</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.bjsxt.mapper.LogMapper"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 当多参数时，不需要写parameterType --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- #&#123;&#125;里面不能用0、1,要用arg0,arg1，mybatis版本不同，传参名不同 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selByAccInAccount"</span> <span class="attr">resultType</span>=<span class="string">"log"</span>&gt;</span></span><br><span class="line">	select * from log where accin=#&#123;arg0&#125; and accout=#&#123;arg1&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>12.6.可以使用注解方式</p>
<p>​    6.1在接口中声明方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">LogMapper</span> </span>&#123;</span><br><span class="line">	<span class="function">List&lt;Log&gt; <span class="title">selByAccInAccount</span><span class="params">(@Param(<span class="string">"accin"</span>)</span>String accin123,@<span class="title">Param</span><span class="params">(<span class="string">"accout"</span>)</span>String accout456)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​    6.2在mapper.xml中添加</p>
<p>​        6.2.1#{}里面写@Param(“内容”)参数中内容</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.bjsxt.mapper.LogMapper"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selByAccInAccount"</span> <span class="attr">resultType</span>=<span class="string">"log"</span>&gt;</span></span><br><span class="line">	select * from log where accin=#&#123;accin&#125; and accout=#&#123;accout&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="动态SQL"><a href="#动态SQL" class="headerlink" title="动态SQL"></a>动态SQL</h1><p>1.根据不同的条件需要执行不同的SQL命令，称为动态SQL</p>
<p>2.MyBatis中动态SQL中在mapper.xml中添加逻辑判断等。</p>
<p>3.if使用</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.bjsxt.mapper.LogMapper"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selByAccinAccount"</span> <span class="attr">resultType</span>=<span class="string">"log"</span>&gt;</span></span><br><span class="line">	select * from log where 1=1</span><br><span class="line">	<span class="comment">&lt;!-- OGNL表达式，直接写key或对象的属性，不需要添加任何特字符号 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"accin!=null and accin!=''"</span>&gt;</span></span><br><span class="line">	and accin=#&#123;accin&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"accout!=null and accout!=''"</span>&gt;</span></span><br><span class="line">	and accout=#&#123;accout&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="4">
<li><p><code>&lt;where&gt;</code></p>
<p>4.1当编写where标签时，如果内容中第一个是and去掉第一个and</p>
<p>4.2如果 <code>&lt;where&gt;</code>中有内容会生成where关键字，如果没有where内容就不生成where关键字</p>
<p>4.3使用示例</p>
<p>​    4.3.1比直接使用 <code>&lt;if&gt;</code>少写了where1=1</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.bjsxt.mapper.LogMapper"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selByAccinAccount"</span> <span class="attr">resultType</span>=<span class="string">"log"</span>&gt;</span></span><br><span class="line">	select * from log </span><br><span class="line">	<span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- OGNL表达式，直接写key或对象的属性，不需要添加任何特字符号 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"accin!=null and accin!=''"</span>&gt;</span></span><br><span class="line">	and accin=#&#123;accin&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"accout!=null and accout!=''"</span>&gt;</span></span><br><span class="line">	and accout=#&#123;accout&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>5.<code>&lt;choose&gt;</code> <code>&lt;when&gt;</code>  <code>&lt;otherwise&gt;</code></p>
<p>​    5.1只要有一个成立，其他都不执行</p>
<p>​    5.2代码示例</p>
<p>​        5.2.1如果accin和accout都不是null或不是“”     生成的sql中只有where  accin=？</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selByAccinAccount"</span> <span class="attr">resultType</span>=<span class="string">"log"</span>&gt;</span></span><br><span class="line">	select * from log </span><br><span class="line">	<span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"accin!=null and accin!=''"</span>&gt;</span></span><br><span class="line">				and accin=#&#123;accin&#125;</span><br><span class="line">			<span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"accout!=null and accout!=''"</span>&gt;</span></span><br><span class="line">				and accout=#&#123;accout&#125;</span><br><span class="line">			<span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>6.<code>&lt;set&gt;</code>用在修改SQL中set从句</p>
<p>​    6.1作用：去掉最后一个逗号</p>
<p>​    6.2作用：如果  <code>&lt;set&gt;</code>里面有内容生成set关键字，没有就不生成</p>
<p>​    6.3示例</p>
<p>​        6.3.1id#{}目的是防止 <set>中没有内容，mybatis不生成set关键字，如果修改中没有set从句，SQL语法错误</set></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"upd"</span> <span class="attr">parameterType</span>=<span class="string">"log"</span>&gt;</span></span><br><span class="line">	update log </span><br><span class="line">	<span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">	id=#&#123;id&#125;,</span><br><span class="line">	<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"accIn!=null and accIn!=''"</span>&gt;</span></span><br><span class="line">		accin=#&#123;accIn&#125;,</span><br><span class="line">	<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"accOut!=null and accOut!=''"</span>&gt;</span></span><br><span class="line">	accout=#&#123;accOut&#125;,</span><br><span class="line">	<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">	where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>7.Trim</p>
<p>​    7.1prefix：   在前面添加内容</p>
<p>​    7.2prefixOverrides ：  去掉前面内容</p>
<p>​    7.3suffix：  在后面添加内容</p>
<p>​    7.4suffixOverrides： 去掉后面内容</p>
<p>​    7.5执行顺序先去掉内容后添加内容</p>
<p>​    7.6代码示例</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"upd"</span> <span class="attr">parameterType</span>=<span class="string">"log"</span>&gt;</span></span><br><span class="line">	update log </span><br><span class="line">	<span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">"set"</span> <span class="attr">suffixOverrides</span>=<span class="string">","</span>&gt;</span></span><br><span class="line">	a=a,</span><br><span class="line">	<span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br><span class="line">	where id=100</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="8">
<li><p><code>&lt;bind&gt;</code></p>
<p>8.1作用：给参数重新赋值</p>
<p>8.2场景：</p>
<p>​    8.2.1模糊查询</p>
<p>​    8.2.2在原内容前或后添加内容    </p>
<p>8.3示例</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selByLog"</span> <span class="attr">parameterType</span>=<span class="string">"log"</span> <span class="attr">resultType</span>=<span class="string">"log"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bind</span> <span class="attr">name</span>=<span class="string">"accin"</span> <span class="attr">value</span>=<span class="string">"'%'+accin+'%'"</span>/&gt;</span></span><br><span class="line">	#&#123;money&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="9">
<li><p><code>foreach</code>  标签</p>
<p>9.1循环参数内容，还具备在内容的前后添加内容，还具备添加分隔符功能</p>
<p>9.2适用场景：in查询中。批量新增中(mybatis中foreach效率比较低)</p>
<p>​    9.2.1如果希望批量新增，SQL命令</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">insert into log <span class="title">values</span><span class="params">(<span class="keyword">default</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span>,<span class="params">(<span class="keyword">default</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span>,<span class="params">(<span class="keyword">default</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>)</span></span></span><br></pre></td></tr></table></figure>
<p>​    9.2.2openSession()必须指定</p>
<p>​        9.2.2.1底层JDBC的PreparedStatement.addBatch();</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">factory.openSession(ExcutorType.BATCH);</span><br></pre></td></tr></table></figure>
<p>9.3示例</p>
<p>​    9.3.1collection=””  要遍历的集合</p>
<p>​    9.3.2item  迭代变量#{迭代变量名}获取内容</p>
<p>​    9.3.3open  循环后左侧添加内容</p>
<p>​    9.3.4close  循环后右侧添加内容</p>
<p>​    9.3.5separator  每次循环时，元素之间的分隔符</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selIn"</span> <span class="attr">parameterType</span>=<span class="string">"list"</span> <span class="attr">resultType</span>=<span class="string">"log"</span>&gt;</span></span><br><span class="line">select * from log where id in </span><br><span class="line"><span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"list"</span> <span class="attr">item</span>=<span class="string">"abc"</span> <span class="attr">open</span>=<span class="string">"("</span> <span class="attr">close</span>=<span class="string">")"</span> <span class="attr">separator</span>=<span class="string">","</span>&gt;</span></span><br><span class="line">#&#123;abc&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>10 <code>&lt;sql&gt;</code>和 <code>&lt;include&gt;</code></p>
<p>10.1某些SQL片段如果希望复用，可以使用 <code>&lt;sql&gt;</code>定义这个片段</p>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Sql</span> <span class="attr">id</span>=<span class="string">"mysql"</span>&gt;</span></span><br><span class="line">	id,accin,accout,money</span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>​    10.2在 <code>&lt;select&gt;</code>或 <code>&lt;delete&gt;</code>或 <code>&lt;update&gt;</code> 或 <code>&lt;insert&gt;</code>中使用 <code>&lt;include&gt;</code>引用</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">	select <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"mysql"</span>&gt;</span><span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">	from log</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="ThreadLocal"><a href="#ThreadLocal" class="headerlink" title="ThreadLocal"></a>ThreadLocal</h1><p>1.线程容器，给线程绑定一个Object内容后，只要线程不变，可以随时取出</p>
<p>​    1.1改变线程，无法取出内容</p>
<p>2.语法示例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> ThreadLocal&lt;String&gt; threadLocal=<span class="keyword">new</span> ThreadLocal&lt;&gt;();</span><br><span class="line">	threadLocal.set(<span class="string">"测试"</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">new</span> Thread() &#123;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			String result=threadLocal.get();</span><br><span class="line">			System.out.println(result);</span><br><span class="line">		&#125;;</span><br><span class="line">	&#125;.start();</span><br></pre></td></tr></table></figure>
<h1 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h1><p>1.应用程序和数据库交互的过程是一个相对比较耗时的过程</p>
<p>2.缓存存在的意义：让应用程序减少对数据库的访问，提升程序运行效率</p>
<p>3.MyBatis中默认SqlSession缓存开启</p>
<p>​    3.1同一个SqlSession对象调用同一个 <code>&lt;select&gt;</code>时，只有第一次访问数据库，第一次之后把查询结果缓存到SqlSession缓存区(内存)中</p>
<p>​    3.2缓存的是statement对象(简单记忆必须是用一个 <code>&lt;select&gt;</code>)</p>
<p>​        3.2.1在mybatis中，一个 <code>&lt;select&gt;</code>对应一个 statement对象</p>
<p>​    3.3有效范围必须是同一个SqlSession对象</p>
<p>4.缓存流程</p>
<p>​    4.1步骤一：先去缓存区中找是否存在statement</p>
<p>​    4.2步骤二：返回结果</p>
<p>​    4.3步骤三：如果没有缓存statement对象，去数据库获取数据</p>
<p>​    4.4步骤四：数据库返回查询结果</p>
<p>​    4.5步骤五：把查询结果放到对应的缓冲区中</p>
<p>5.SqlSessionFactory缓存</p>
<p>​    5.1又叫：二级缓存</p>
<p>​    5.2有效范围：同一个factory内哪个SqlSession都可以获取</p>
<p>​    5.3什么时候使用二级缓存：</p>
<p>​        5.3.1当数据频繁被使用，很少被修改</p>
<p>​    5.4使用二级缓存的步骤</p>
<p>​        5.4.1在mapper.xml中添加</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cache</span> <span class="attr">readOnly</span>=<span class="string">"true"</span>&gt;</span> <span class="tag">&lt;/<span class="name">cache</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>​        5.4.2如果不写readOnly=”true”，需要把实体类序列化</p>
<p>​    5.5当SqlSession对象close()时或commit()时，会把SqlSession缓存的数据刷(flush)到SqlSessionFactory缓冲区中。</p>
<h1 id="MyBatis实现多表查询"><a href="#MyBatis实现多表查询" class="headerlink" title="MyBatis实现多表查询"></a>MyBatis实现多表查询</h1><p>​    1.MyBatis实现多表查询方式</p>
<p>​        1.1业务装配：对两个表编写单表查询语句，在业务(service)把查询的两个结果进行关联</p>
<p>​        1.2使用Auto Mapping特性，在实现两表查询时通过别名完成映射</p>
<p>​        1.3使用MyBatis的 <code>&lt;resultMap&gt;</code>属性进行实现</p>
<p>​    2.多表查询时，类中包含另一个类的对象的分类</p>
<p>​        2.1单个对象</p>
<p>​        2.2集合对象</p>
<ol start="3">
<li><p><code>&lt;resultMap&gt;</code>标签</p>
<p>3.1 <code>&lt;resultType&gt;</code>标签写在mapper.xml中，有程序员控制SQL查询结果与实体类的映射关系</p>
<p>​    3.1.1默认MyBatis使用Auto Mapping特性</p>
<p>3.2使用 <code>&lt;resultType&gt;</code>标签时， <select>标签不写resultType属性，而是使用resultType属性引用 <code>&lt;resultType&gt;</code>标签</select></p>
<p>3.3使用resultType实现单表映射关系</p>
<p>​    3.3.1数据库设计</p>
<p>​    3.3.2实体类设计</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Teacher</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id1;</span><br><span class="line">    <span class="keyword">private</span> String name1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​    3.3.3mapper.xml代码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"teacher"</span> <span class="attr">id</span>=<span class="string">"mymap"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 主键使用id标签配置映射关系 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id1"</span> /&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 其他列使用result标签配置映射关系 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">property</span>=<span class="string">"name1"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultType</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selAll"</span> <span class="attr">resultType</span>=<span class="string">"mymap"</span>&gt;</span></span><br><span class="line">	select * from teacher</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>4.使用resultMap实现关联单个对象(N+1方式)</p>
</li>
</ol>
<p>​    4.1N+1查询方式，先查询出某个表的全部信息，再根据这个表的信息查询另一个表的信息</p>
<p>​    4.2与业务装配的区别：</p>
<p>​        4.2.1在service里面写的代码由mybatis完成装配</p>
<p>​    4.3实现步骤</p>
<p>​        4.3.1在student实现类中包含了一个teacher对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> tid;</span><br><span class="line">    <span class="keyword">private</span> Teacher teacher;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​        4.3.2在TeacherMapper中提供一个查询</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selById"</span> <span class="attr">resultType</span>=<span class="string">"teacher"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">	select * from teacher where id=#&#123;0&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>​        4.3.3在StudentMapper中</p>
<p>​            4.3.3.1 <code>&lt;association&gt;</code>装配一个对象时使用</p>
<p>​            4.3.3.2property：对象在类中的属性名</p>
<p>​            4.3.3.3select：通过哪个查询能查询出这个对象的信息</p>
<p>​            4.3.3.4column：把当前表的哪个列的值作为参数传递给另一个查询</p>
<p>​            4.3.3.5大前提是使用N+1方式时，如果列名和属性名相同可以不配置，使用Auto  mapping特性。但是mybatis默认只会给列专配一次</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultType</span> <span class="attr">type</span>=<span class="string">"student"</span> <span class="attr">id</span>=<span class="string">"stuMap"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"name"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"age"</span> <span class="attr">column</span>=<span class="string">"age"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"tid"</span> <span class="attr">column</span>=<span class="string">"tid"</span>/&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"teacher"</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">select</span>=<span class="string">"com.bjsxt.mapper.TeacherMapper.selById"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">column</span>=<span class="string">"tid"</span>&gt;</span><span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selAll"</span> <span class="attr">resultMap</span>=<span class="string">"stuMap"</span>&gt;</span></span><br><span class="line">		select * from sudent</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>​            4.3.3.6可以把上列代码简化成</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultType</span> <span class="attr">type</span>=<span class="string">"student"</span> <span class="attr">id</span>=<span class="string">"stuMap"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"tid"</span> <span class="attr">column</span>=<span class="string">"tid"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"teacher"</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">select</span>=<span class="string">"com.bjsxt.mapper.TeacherMapper.selById"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">column</span>=<span class="string">"tid"</span>&gt;</span><span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selAll"</span> <span class="attr">resultMap</span>=<span class="string">"stuMap"</span>&gt;</span></span><br><span class="line">		select * from sudent</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>​    5.N+1方式和联合查询方式对比</p>
<p>​        5.1N+1：需求不确定时</p>
<p>​        5.2联合查询：需求中确定查询时两个表一定都查询</p>
<p>​    6.N+1名称由来</p>
<p>​        6.1举例：学生中有3条数据</p>
<p>​        6.2需求：查询所有学生信息及授课老师信息</p>
<p>​        6.3需要执行的SQL命令</p>
<p>​            6.3.1查询全部学生信息：select  *  from  学生</p>
<p>​            6.3.2执行3遍select * from 老师 where id=学生的外键</p>
<p>​        6.4使用多条SQL命令查询两表数据时，如果希望把需要的数据都查询出来，需要执行N+1条SQL才能把所有数据查询出来</p>
<p>​        6.5缺点：效率低</p>
<p>​        6.6优点：如果有的时候不需要查询学生时，同时查询老师，只需要执行一个select * from student</p>
<p>​        6.7适用场景：有的时候需要查询学生同时查询老师，有的时候只需要查询学生</p>
<p>​        6.8如何解决N+1查询带来的效率低的问题</p>
<p>​            6.8.1默认带的前提：每次都是两个查询</p>
<p>​            6.8.2使用两表联合查询</p>
<h1 id="使用-lt-resultType-gt-查询关联集合对象"><a href="#使用-lt-resultType-gt-查询关联集合对象" class="headerlink" title="使用 &lt;resultType&gt;查询关联集合对象"></a>使用 <code>&lt;resultType&gt;</code>查询关联集合对象</h1><p>​    1.在Teacher中添加 <code>List&lt;Student&gt;</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Teacher</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Student&gt; list;<span class="comment">//这里重点</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​    2.在StudentMapper.xml中添加通过tid查询</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selByTid"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"student"</span>&gt;</span></span><br><span class="line">	select * from student where tid=#&#123;0&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>​    3.在TeacherMapper.xml中添加查询全部</p>
<p>​        3.1 <code>&lt;collection/&gt;</code>当属性是集合类型时使用的标签</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"teacher"</span> <span class="attr">id</span>=<span class="string">"mymap"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">property</span>=<span class="string">"name"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"list"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">select</span>=<span class="string">"com.bjsxt.mapper.StudentMapper.selByTid"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selAll"</span> <span class="attr">resultType</span>=<span class="string">"mymap"</span>&gt;</span></span><br><span class="line">	select * from teacher</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>​    4.使用 <code>&lt;resultType&gt;</code>实现加载集合数据（联合查询方式）</p>
<p>​        4.1在teacherMapper.xml中添加</p>
<p>​            4.1.1mybatis可以通过主键判断对象是否被加载过</p>
<p>​            4.1.2不需要担心创建重复Teacher</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"teacher"</span> <span class="attr">id</span>=<span class="string">"mymap1"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"tid"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"tname"</span> <span class="attr">property</span>=<span class="string">"name"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"list"</span> <span class="attr">ofType</span>=<span class="string">"student"</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"sid"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"sname"</span> <span class="attr">peoperty</span>=<span class="string">"name"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"age"</span> <span class="attr">peoperty</span>=<span class="string">"age"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"tid"</span> <span class="attr">peoperty</span>=<span class="string">"tid"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selAll"</span> <span class="attr">resultMap</span>=<span class="string">"mymap1"</span>&gt;</span></span><br><span class="line">	select t.id tid,t.name tname,s.id sid,s.name sname,age,tid from teacher t LEFT JOIN student s on t.id=s.tid;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="使用Auto-Mapping结合别名实现多表查询"><a href="#使用Auto-Mapping结合别名实现多表查询" class="headerlink" title="使用Auto Mapping结合别名实现多表查询"></a>使用Auto Mapping结合别名实现多表查询</h1><p>​    1只能使用多表联合查询方式</p>
<p>​    2要求：查询出的列名和属性名相同</p>
<p>​    3实现方式</p>
<p>​        3.1在SQL中是关键字符，两测添加反单引号</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selAll"</span> <span class="attr">resultMap</span>=<span class="string">"student"</span>&gt;</span></span><br><span class="line">	select t.id `teacher.id`,t.name `teacher.name`,s.id sid,s.name sname,age,tid from teacher t LEFT JOIN student s on t.id=s.tid;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="MyBatis注解"><a href="#MyBatis注解" class="headerlink" title="MyBatis注解"></a>MyBatis注解</h1><p>​    1注解：为了简化配置文件</p>
<p>​    2MyBatis的注解简化mapper.xml文件</p>
<p>​        2.1如果涉及动态SQL依然使用mapper.xml</p>
<p>​    3mapper.xml和注解可以共存</p>
<p>​    4使用注解时mybatis.xml中 <code>&lt;mappers&gt;</code>使用</p>
<p>​        4.1 <code>&lt;package/&gt;</code></p>
<p>​        4.2 <code>&lt;mapper class=&quot;&quot;/&gt;</code></p>
<p>​    5实现查询</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Select</span>(<span class="string">"select * from teacher"</span>)</span><br><span class="line"><span class="function">List&lt;Teacher&gt; <span class="title">selAll</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>
<p>​    6实现新增</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Insert</span>(<span class="string">"insert into teacher values(default,#&#123;name&#125;)"</span>)</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">insTeahcer</span><span class="params">(Teacher teacher)</span></span>;</span><br></pre></td></tr></table></figure>
<p>​    7实现修改</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Update</span>(<span class="string">"update teacher set name=#&#123;name&#125; where id=#&#123;id&#125;"</span>)</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">updTeacher</span><span class="params">(Teacher teacher)</span></span>;</span><br></pre></td></tr></table></figure>
<p>​    8实现删除</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Delete</span>(<span class="string">"delete from teacher where id=#&#123;0&#125;"</span>)</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">delById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br></pre></td></tr></table></figure>
<p>​    9使用注解实现 <code>&lt;resultMap&gt;</code>功能</p>
<p>​        9.1以N+1举例</p>
<p>​        9.2在StudentMapper接口添加查询</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Select</span>(<span class="string">"select * from student where tid=#&#123;0&#125;"</span>)</span><br><span class="line">List&lt;Student&gt;selByTid(<span class="keyword">int</span> tid);</span><br></pre></td></tr></table></figure>
<p>​        9.3在TeacherMapper接口中添加</p>
<p>​            9.3.1@Results()相当于 <code>&lt;resultMap&gt;</code></p>
<p>​            9.3.2@Result()相当于 <code>&lt;id/&gt;</code>或  <code>&lt;result/&gt;</code>,@Result(id=true)相当于 <code>&lt;id/&gt;</code></p>
<p>​            3.3.3@Many()相当于 <code>&lt;collection/&gt;</code></p>
<p>​            3.3.4@One()相当于 <code>&lt;association/&gt;</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Results</span>(value=&#123;</span><br><span class="line">    <span class="meta">@Result</span>(id=<span class="keyword">true</span>,property=<span class="string">"id"</span>,column=<span class="string">"id"</span>),</span><br><span class="line">    <span class="meta">@Result</span>(property=<span class="string">"name"</span>,column=<span class="string">"name"</span>),</span><br><span class="line">    <span class="meta">@Result</span>(property=<span class="string">"list"</span>,column=<span class="string">"id"</span>,many=<span class="meta">@Many</span>(select=<span class="string">"com.bjsxt.mapper.StudentMapper.selByTid"</span>))</span><br><span class="line">&#125;)</span><br><span class="line"><span class="meta">@Select</span>(<span class="string">"select *from teacher"</span>)</span><br><span class="line"><span class="function">List&lt;Teacher&gt; <span class="title">selTeacher</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>
<h1 id="运行原理"><a href="#运行原理" class="headerlink" title="运行原理"></a>运行原理</h1><p>​    1.运行过程中涉及到的类</p>
<p>​        1.1  Reources MyBatis中IO流的工具类</p>
<p>​            作用：加载配置文件</p>
<p>​        1.2  SqlSessionFactoryBuilder()构建器</p>
<p>​            作用：创建SqlSessionFactory接口的实现类</p>
<p>​        1.3  XMLConfigBuilder MyBatis全局配置文件内容构建器类</p>
<p>​            作用：负责读取流内容并转换为JAVA代码</p>
<p>​        1.4  Configuration封装了全局配置文件所有配置信息</p>
<p>​            全局配置文件内容放在20.1.4Configuration中</p>
<p>​        1.5  DefaultSqlSessionFactory是SqlSessionFactory接口的实现类</p>
<p>​        1.6  Transaction事务类，每一个SqlSession会带有一个Transaction对象</p>
<p>​        1.7  TransactionFactory事务工厂：负责生产Transaction</p>
<p>​        1.8  Executor  MyBatis执行器</p>
<p>​            作用：负责执行SQL命令，相当于JDBC中statement对象(或PreparedStatement或CallableStatement)，默认的执行器是SimpleExcutor，批量操作是BatchExcutor，通过openSession(参数控制)</p>
<p>​        1.9  DefaultSqlSession是SqlSession接口的实现类</p>
<p>​        1.10  ExceptionFactory  MyBatis中异常工厂</p>
<p>​    2.文字解释</p>
<p>​    在MyBatis运行开始时需要先通过Resources加载全局配置文件，下面需要实例化SqlSessionFactoryBuilder构建器帮助SqlSessionFactory接口实现类DefaultSqlSessionFactory</p>
<p>​    在实例化DefaultSqlSessionFactory之前需要先创建XMLConfigBuilder解析全局配置文件流，并把解析结果存放在Configuration中，之后把Configuration传递给DefaultSqlSessionFactory，到此SqlSessionFactory创建成功</p>
<p>​    由SqlSessionFactory工厂创建SqlSession，每次创建SqlSession时都需要由TransactionFactory创建Transaction对象，同时还需要创建SqlSession的执行器Excutor，最好实例化DefaultSqlSession，传递给SqlSession接口</p>
<p>​    根据项目需求使用SqlSession接口中的API完成具体事务操作</p>
<p>​    如果事务执行失败，需要进行rollback回滚事务</p>
<p>​    如果事务执行成功，提交给数据库，关闭SqlSession</p>
<p>​    到此就是MyBatis的运行原理</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/25/jsp学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wangwei">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="二十一的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/25/jsp学习/" class="post-title-link" itemprop="url">JSP学习</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-05-25 15:08:25" itemprop="dateCreated datePublished" datetime="2019-05-25T15:08:25+08:00">2019-05-25</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-05-26 21:20:37" itemprop="dateModified" datetime="2019-05-26T21:20:37+08:00">2019-05-26</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="JSP指令"><a href="#JSP指令" class="headerlink" title="JSP指令"></a>JSP指令</h3><ul>
<li>page指令:通常位于jsp页面的顶端,同一个页面可以有多个page指令(language,import,contentType属性)</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span>%&gt;java</span><br></pre></td></tr></table></figure>
<ul>
<li>include指令:将一个外部文件嵌入到当前JSP文件中,同时解析这个页面中的JSP语句</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ include file=<span class="string">"head.jsp"</span>%&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>taglib指令:使用标签库定义新的自定义标签,在JSP页面中启用定制行为</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span> %&gt;</span><br></pre></td></tr></table></figure>
<h3 id="JSP注释"><a href="#JSP注释" class="headerlink" title="JSP注释"></a>JSP注释</h3><ul>
<li>html注释<!--  -->,在客户端可见</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--我是个大傻子--&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>jsp注释&lt;%–   –%&gt;,在客户端不可见</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%--哈哈哈--%&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>jsp脚本注释 //单行注释      /**/多行注释</li>
</ul>
<h3 id="JSP脚本"><a href="#JSP脚本" class="headerlink" title="JSP脚本"></a>JSP脚本</h3><p>在JSP页面中执行的java代码</p>
<p>语法:&lt;%java代码%&gt;</p>
<h3 id="JSP声明"><a href="#JSP声明" class="headerlink" title="JSP声明"></a>JSP声明</h3><p>语法:&lt;%!  代码  %&gt;</p>
<p>注意这有一个!符号</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;%!</span><br><span class="line"><span class="keyword">int</span> count=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span></span>&#123;</span><br><span class="line">	count++;</span><br><span class="line">	<span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
<h3 id="JSP表达式"><a href="#JSP表达式" class="headerlink" title="JSP表达式"></a>JSP表达式</h3><p>语法&lt;%=表达式%&gt;//注意最后没有分号,=和%中间不能有空格</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;p&gt;您好,您是本站的第&lt;%=getCount() %&gt;位来访者!&lt;/p&gt;</span><br></pre></td></tr></table></figure>
<h3 id="JSP内置对象"><a href="#JSP内置对象" class="headerlink" title="JSP内置对象"></a>JSP内置对象</h3><p>内置对象:JSP内置对象是Web容器创建的一组对象,不使用new关键字就可以使用的内置对象.</p>
<p>常用的内置对象5个:out,request,response,session,application</p>
<p>不常用4个:Page,pageContext,exception,config</p>
<p>共九大内置对象</p>
<ul>
<li>out对象</li>
</ul>
<p>out对象是JspWriter类的实例,是向客户端输出内容常用的对象</p>
<p>常用方法</p>
<p>1.void printlin()向客户端打印字符串</p>
<p>2.void clear()清除缓冲区的内容,如果在flush之后调用会抛出异常</p>
<p>3.void clearBuffer()清除缓冲区的内容,如果在flush之后调用不会抛出异常</p>
<p>4.void flush()将缓冲区内容输出到客户端</p>
<p>5.int getBufferSize()返回缓冲区以字节数的大小,如不设缓冲区则为0</p>
<p>6.int getRemaining()返回缓冲区还剩余多少可用</p>
<p>7.boolean isAutoFlush()返回缓冲区满时,是自动清空还是抛出异常</p>
<p>8.void close()关闭输出流</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;h2&gt;out内置对象&lt;/h2&gt;</span><br><span class="line">&lt;%</span><br><span class="line">out.println(<span class="string">"&lt;h3&gt;静夜思&lt;/h3&gt;"</span>);</span><br><span class="line">out.println(<span class="string">"床前明月光&lt;br&gt;"</span>);</span><br><span class="line">out.println(<span class="string">"疑是地上霜&lt;br&gt;"</span>);</span><br><span class="line">out.println(<span class="string">"举头望明月&lt;br&gt;"</span>);</span><br><span class="line">out.println(<span class="string">"低头思故乡&lt;br&gt;"</span>);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;</span><br><span class="line">缓冲区大小:&lt;%=out.getBufferSize() %&gt;<span class="keyword">byte</span>&lt;br&gt;</span><br><span class="line">缓冲区剩余大小:&lt;%=out.getRemaining() %&gt;<span class="keyword">byte</span>&lt;br&gt;</span><br><span class="line">是否自动清空缓冲区:&lt;%=out.isAutoFlush() %&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;<span class="keyword">boolean</span>&lt;br&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>表单的两种提交方式:get和post</li>
</ul>
<p>1.get:以明文的方式通过UPL提交数据,数据在URL中可以看到。提交的数据最大不超过2KB.安全性较低但效率比post方式高。适合提交数据量不大，安全性不高的数据。比如：搜索、查询等功能。</p>
<p>2.post：将用户提交的信息封装在html，header内。适合提交数据量大，安全性高的用户信息。比如：注册、修改、上传等功能。</p>
<ul>
<li>request对象</li>
</ul>
<p>​    客户端的请求信息被封装在request对象中，通过它才能了解到客户的需求，然后做出响应。它是HttpServletRequest类的实例。request对象具有请求域，即完成客户端的请求之前，该对象一直有效。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">String name = request.getParameter(<span class="string">"name"</span>);</span><br><span class="line"></span><br><span class="line"> request.setAttribute(<span class="string">"name"</span>,name);</span><br><span class="line"></span><br><span class="line"> request.getAttribute(<span class="string">"name"</span>);</span><br></pre></td></tr></table></figure>
<hr>
<ul>
<li>response对象</li>
</ul>
<p>​    response对象包含了响应客户请求的有关信息，但在JSP中很少直接用到它。它是HttpServletResponse类的实例。response对象具有页面作用域，即访问一个页面时，该页面内容的response对象只能对这次访问有效，其它页面的response对象对当前页面无效。</p>
<p>请求转发与重定向</p>
<p>请求重定向：<strong>客户端行为</strong>，<strong><u>respons.sendRedirect()</u></strong>，从本质上讲等同于两次请求，前一次的请求对象不会保存，地址栏的<strong>URL地址会改变</strong>。</p>
<p>请求转发：<strong>服务器行为</strong>，<strong><u>request.getRequestDispatcher().forward(request,response);</u></strong>是一次请求，转发后请求对象会保存，地址栏的<strong>URL地址不会改变</strong>。</p>
<ul>
<li>session对象</li>
</ul>
<p>在服务器的内存中保存着不同用户的session。</p>
<img src="/2019/05/25/jsp学习/session.png" title="This is an image">
<p>session对象在第一个JSP页面被装载时自动创建，完成会话期管理。</p>
<p>从一个客户打开浏览器并连接到服务器开始，到客户关闭浏览器离开这个服务器结束，被称为一个会话。</p>
<p>当一个客户访问一个服务器时，可能在服务器的几个页面切换，服务器应当通过某种办法知道这是一个客户，就需要session对象。</p>
<p>session对象时HttpSession类的实例。</p>
<h3 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h3><p>cookie是Web服务器保存在客户端的一系列文本信息。</p>
<p>典型应用一：判断注册用户是否已登录网站。</p>
<p>典型应用二：“购物车”的处理</p>
<ul>
<li>Cookie作用</li>
</ul>
<p>对特定对象的追踪</p>
<p>保存用户网页浏览记录与习惯</p>
<p>简化登录</p>
<p>安全风险：容易泄露用户信息</p>
<ul>
<li>JSP中创建与使用Cookie</li>
</ul>
<p>创建cookie对象</p>
<p>Cookie newCookie=new Cookie(String key，Object value);</p>
<p>写入cookie对象</p>
<p>response.addCookie(newCookie);</p>
<p>读取cookie对象</p>
<p>Cookie[] cookies=request.getCookies();</p>
<p>session与cookie的区别</p>
<img src="/2019/05/25/jsp学习/session与cookie.png" title="This is an image">
<p>### </p>
<h3 id="指令与动作"><a href="#指令与动作" class="headerlink" title="指令与动作"></a>指令与动作</h3><ul>
<li>include指令</li>
</ul>
<p>语法:&lt;%@  include  file=”URL”%&gt;</p>
<ul>
<li>include动作</li>
</ul>
<p>语法:&lt;jsp:  include page=”URL”   flush=”true|false”/&gt;</p>
<p>page:要包含的页面</p>
<p>flush:被包含的页面是否从缓冲区读取</p>
<p>include指令与include动作区别</p>
<img src="/2019/05/25/jsp学习/include指令与动作.png" title="This is an image">
<ul>
<li>forward动作</li>
</ul>
<p>语法:&lt;jsp:forward  page=”URL”/&gt;</p>
<p>等同于:request.getRequestDispatcher(“/url”).forward(request,response);</p>
<ul>
<li>param动作</li>
</ul>
<p>语法:&lt;jsp:param name=”参数名”  value=”参数值”&gt;</p>
<p>常常与&lt;jsp: forward&gt;一起使用,作为其子标签</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;jsp:forward page=<span class="string">"user.jsp"</span>&gt;</span><br><span class="line">&lt;jsp:param value=<span class="string">"admin@123.net"</span> name=<span class="string">"email"</span>/&gt;<span class="comment">//若原来没有email,则在request域中增添 一个emial,user.jsp,接收到的参数多了一个email;若原来有email,则将email修改为admin@123.net</span></span><br><span class="line">&lt;jsp:forward&gt;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/24/书上遇到的问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wangwei">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="二十一的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/24/书上遇到的问题/" class="post-title-link" itemprop="url">基于《Java Web程序设计任务教程》学习遇到的问题</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-05-24 16:13:52 / 修改时间：16:26:31" itemprop="dateCreated datePublished" datetime="2019-05-24T16:13:52+08:00">2019-05-24</time>
            

            
              

              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="第10章-数据库连接池与DBUtils工具"><a href="#第10章-数据库连接池与DBUtils工具" class="headerlink" title="第10章       数据库连接池与DBUtils工具"></a>第10章       数据库连接池与DBUtils工具</h2><h3 id="一-DBCP数据源"><a href="#一-DBCP数据源" class="headerlink" title="一.DBCP数据源"></a>一.DBCP数据源</h3><p>下载链接:<a href="http://commons.apache.org/proper/" target="_blank" rel="noopener">http://commons.apache.org/proper/</a></p>
<p>打开链接后是这样的:</p>
<img src="/2019/05/24/书上遇到的问题/1.png" title="This is an image">
<p>### </p>
<p>按照书上所说在上面的网址中下载commons-dbcp.jar包和commoms-pool.jar。</p>
<p>1.找到commons-dbcp/，点开</p>
<img src="/2019/05/24/书上遇到的问题/2.png" title="This is an image">
<p>2.在Releases下找到download，点开。根据版本下载相应的包，下载bin.zip和src.zip。</p>
<img src="/2019/05/24/书上遇到的问题/3.png" title="This is an image">
<p>3.bin.zip解压后打开bin文件夹，里面就有.jar。src.zip是用来查看文档用的，就是你用了一个外包里面的函数，想看一下这个函数的内部有些什么东西，就可以给那个外包添加这个src.zip。当你ctrl+鼠标左键便可以查看了。这里已经更新到了commons-dbcp2-2.6.0，跟书上的版本不同。</p>
<p>4.按照书上P287的例题做一遍，会发现程序报错</p>
<img src="/2019/05/24/书上遇到的问题/4.png" title="This is an image">
<p>后来我百度了一下，使用dbcp2除了需要书上所说的依赖包commons-pool.jar外，<strong><u>还需要一个commons-logging.jar包</u></strong>。这个包也是在上面那个链接里面下载。</p>
<p>5.还有就是如果大家使用的dbcp2的话，按照书上写的bds.之后根本没有<strong><u>setMaxActive()</u></strong>这个函数，因为在bdcp2包中这个函数换了一个名字，叫做<strong><u>setMaxTotal</u></strong>。所以非常坑，一个简单的程序竟是错，搞得人心态都崩了。</p>
<h3 id="二、C3P0数据源"><a href="#二、C3P0数据源" class="headerlink" title="二、C3P0数据源"></a>二、C3P0数据源</h3><p>下载链接：<a href="https://sourceforge.net/projects/c3p0/" target="_blank" rel="noopener">https://sourceforge.net/projects/c3p0/</a></p>
<p>1.打开网页后往下滑，找到下图位置：</p>
<img src="/2019/05/24/书上遇到的问题/5.png" title="This is an image">
<p>也是下载bin.zip和src.zip</p>
<p>2.按照书上P290的例题做一遍会发现会报错：</p>
<img src="/2019/05/24/书上遇到的问题/6.png" title="This is an image">
<p>这是因为除了需要引入c3p0-0.9.5.4.jar外，还需要引入<strong><u>mchange-commons-java-0.2.15.jar</u></strong>，然而书上并没有说，对我们这种菜鸟来说真是一种折磨</p>
<h2 id="第11章-JSP开发模型"><a href="#第11章-JSP开发模型" class="headerlink" title="第11章      JSP开发模型"></a>第11章      JSP开发模型</h2><h3 id="基于书上P310例题遇到的问题"><a href="#基于书上P310例题遇到的问题" class="headerlink" title="基于书上P310例题遇到的问题"></a>基于书上P310例题遇到的问题</h3><p>1.RegisterFormBean.java中的validate函数里面的name.trim(),这个trim（）是什么函数？</p>
<p>trim()方法返回调用字符串对象的一个副本，但是<strong><u>所有起始和结尾的空格都被删除</u></strong>。</p>
<p>2.ControllerServlet里面两个if里面的return可有可无？</p>
<p>当我第一遍敲代码的时候以为这个return是多余的，于是把它去掉了，然后跑一下程序出来了一大坨红色恐怖的XXX，又让我怀疑人生了。</p>
<img src="/2019/05/24/书上遇到的问题/7.png" title="This is an image">
<p>于是我百度了一下这个错误，得到了解决，这个return看似无用，实则有大用！</p>
<p>之前在使用Servlet的时候，总是在 doGet()/doPost() 的最后一行才使用请求转发或者重定向。如果需要根据条件来判断进行不同的请求转发或者重定向就会报错。报异常的原因是重复转发或者重定向了请求，如果有多个转发或者重定向，需要在每个转发或者重定向请求之后加上return语句(最后一个请求转发或者重定向不需要加return)。通过return语句确保在转发或者重定向请求之后返回，避免在执行上边的转发/重定向之后，接着继续往下执行转发/重定向请求，这样就不会再报这个异常了。</p>
<p>原来根据条件判断进行不同的请求转发或者重定向需要在请求之后加一个return语句，<strong><u>来确保在请求转发或重定向之后返回，避免再执行上边的转发或者重定向之后，会继续往下执行转发或者重定向请求</u></strong>。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/10/给javaweb程序设置字符编码过滤器/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wangwei">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="二十一的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/10/给javaweb程序设置字符编码过滤器/" class="post-title-link" itemprop="url">给javaweb出现设置字符编码</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-05-10 20:48:07" itemprop="dateCreated datePublished" datetime="2019-05-10T20:48:07+08:00">2019-05-10</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-05-11 12:59:38" itemprop="dateModified" datetime="2019-05-11T12:59:38+08:00">2019-05-11</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="过滤器简介"><a href="#过滤器简介" class="headerlink" title="过滤器简介"></a>过滤器简介</h3><p>Filter也称之为过滤器，它是Servlet技术中最激动人心的技术，WEB开发人员通过Filter技术，对web服务器管理的所有web资源：例如Jsp, Servlet, 静态图片文件或静态 html 文件等进行拦截，从而实现一些特殊的功能。例如实现URL级别的权限访问控制、过滤敏感词汇、压缩响应信息等一些高级功能。<br>　　Servlet API中提供了一个Filter接口，开发web应用时，如果编写的Java类实现了这个接口，则把这个java类称之为过滤器Filter。通过Filter技术，开发人员可以实现用户在访问某个目标资源之前，对访问的请求和响应进行拦截，如下所示：</p>
<img src="/2019/05/10/给javaweb程序设置字符编码过滤器/fliter.png" title="This is an image">
<h3 id="具体例子体现"><a href="#具体例子体现" class="headerlink" title="具体例子体现"></a>具体例子体现</h3><p>#### </p>
<h4 id="首先我们创建一个index-jsp，里面完成登录界面，提交后交给filter-jsp处理"><a href="#首先我们创建一个index-jsp，里面完成登录界面，提交后交给filter-jsp处理" class="headerlink" title="首先我们创建一个index.jsp，里面完成登录界面，提交后交给filter.jsp处理"></a>首先我们创建一个index.jsp，里面完成登录界面，提交后交给filter.jsp处理</h4><p>具体代码如下：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">   </span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">&lt;title&gt;登录界面&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div style=<span class="string">"margin-left: 35%; margin-top: 100px; font-family: Microsoft YaHei"</span>&gt;</span><br><span class="line">     &lt;h1&gt;登录界面&lt;/h1&gt;</span><br><span class="line">     &lt;form action=<span class="string">"filter.jsp"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">       &lt;table&gt;</span><br><span class="line">         &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;账号:&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;input name="name" type="text"&gt;&lt;/td&gt;</span><br><span class="line">         &lt;/tr&gt;</span><br><span class="line">         &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;密码:&lt;/td&gt;</span><br><span class="line">            &lt;td &gt;&lt;input name="password" type="password"&gt;&lt;/td&gt;</span><br><span class="line">         &lt;/tr&gt;</span><br><span class="line">       &lt;/table&gt;</span><br><span class="line">       &lt;input type=<span class="string">"submit"</span>  value=<span class="string">"登录"</span> style=<span class="string">"font-size: 16px"</span>&gt; </span><br><span class="line">     &lt;/form&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h4 id="然后创建一个filter-jsp，用来处理从index-jsp获取到的request请求里面的name和password。"><a href="#然后创建一个filter-jsp，用来处理从index-jsp获取到的request请求里面的name和password。" class="headerlink" title="然后创建一个filter.jsp，用来处理从index.jsp获取到的request请求里面的name和password。"></a>然后创建一个filter.jsp，用来处理从index.jsp获取到的request请求里面的name和password。</h4><p>代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;%String name=(String)request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">String password=(String)request.getParameter(<span class="string">"password"</span>);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;%=name %&gt;</span><br><span class="line">&lt;%=password %&gt;</span><br></pre></td></tr></table></figure>
<h4 id="页面显示结果"><a href="#页面显示结果" class="headerlink" title="页面显示结果"></a>页面显示结果</h4><p>当账号输入：王伟，密码输入214156时，页面显示结果如下图：</p>
<img src="/2019/05/10/给javaweb程序设置字符编码过滤器/页面显示结果.png" title="This is an image">
<p>可以看到账户输出出现乱码，为什么会出现这种情况呢？</p>
<p>http请求是以ISO-8859-1的编码来传送url的，url通过ISO-8859-1传输，服务器收到这个字节流，默认会以ISO-8859-1来将这个字节流还原成相应的字符串。而ISO-8859-1编码不支持中文，所以会出现乱码。那么我们需要设置request的编码格式为支持中文的编码格式。在获取包括中文信息的用户名文本框的值时，可以在获取表单信息前加上下面代码:</p>
<p><code>&lt;% request.setCharacterEncoding(&quot;UTF-8&quot;);%&gt;</code></p>
<p>加上这段代码后，结果显示如下：</p>
<img src="/2019/05/10/给javaweb程序设置字符编码过滤器/修改后结果.png" title="This is an image">
<p>这样加一段代码可以防止出现乱码，但是如果有很多个jsp文件，那么给每个jsp文件加一段代码是不是会很麻烦？</p>
<p>那么我们就可以通过过滤器解决中文乱码问题。</p>
<h3 id="创建和设置过滤器"><a href="#创建和设置过滤器" class="headerlink" title="创建和设置过滤器"></a>创建和设置过滤器</h3><h4 id="新建一个filter类，鼠标选中src→右键→new→other"><a href="#新建一个filter类，鼠标选中src→右键→new→other" class="headerlink" title="新建一个filter类，鼠标选中src→右键→new→other"></a>新建一个filter类，鼠标选中src→右键→new→other</h4><img src="/2019/05/10/给javaweb程序设置字符编码过滤器/1.png" title="This is an image">
<h4 id="填写相关内容"><a href="#填写相关内容" class="headerlink" title="填写相关内容"></a>填写相关内容</h4><img src="/2019/05/10/给javaweb程序设置字符编码过滤器/2.png" title="This is an image">
<h4 id="没有什么特别需要可以点击finish。"><a href="#没有什么特别需要可以点击finish。" class="headerlink" title="没有什么特别需要可以点击finish。"></a>没有什么特别需要可以点击finish。</h4><p>注意这里不要写superclass，因为你写的filter是<strong>实现filter接口</strong>，而不是继承filter类，这里不需要操作。</p>
<h4 id="通过注解配置filter过滤器"><a href="#通过注解配置filter过滤器" class="headerlink" title="通过注解配置filter过滤器"></a>通过注解配置filter过滤器</h4><p>代码如下:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebFilter</span>(</span><br><span class="line">    filterName=<span class="string">"CharactorFilter"</span>,</span><br><span class="line">	urlPatterns= &#123;<span class="string">"/*"</span>&#125;,</span><br><span class="line">	initParams= &#123;<span class="meta">@WebInitParam</span>(name=<span class="string">"encoding"</span>,value=<span class="string">"UTF-8"</span>)&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>filterName指定过滤器的名字,urlPatterns={“/*”}表示所有url都匹配上initParams= {@WebInitParam(name=”encoding”,value=”UTF-8”)}表示过滤器初始化参数encoding的值为UTF-8。</p>
<p>注解配置的代码应该放在实现filter接口类的前面。</p>
<h4 id="设置字符编码格式"><a href="#设置字符编码格式" class="headerlink" title="设置字符编码格式"></a>设置字符编码格式</h4><p>在CharactorFilter类里面定义一个String变量encoding1并设为null，即：</p>
<p><code>String encoding1=null;</code></p>
<p>然后在初始化函数init中获取初始化配置时设置的encoding值并赋值给在filter类里面的encoding变量，</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig fConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">	<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">	encoding1=fConfig.getInitParameter(<span class="string">"encoding"</span>);<span class="comment">//获取初始化参数encoding的值</span></span><br><span class="line">	System.out.println(<span class="string">"编码 格式过滤器启动"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在filter类里面的doFilter（）函数里面完成编码设置，代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(encoding1!=<span class="keyword">null</span>) &#123;<span class="comment">//判断字符编码是否为空</span></span><br><span class="line">		<span class="comment">//设置请求的编码格式</span></span><br><span class="line">		request.setCharacterEncoding(encoding1);</span><br><span class="line">		<span class="comment">//设置response字符编码</span></span><br><span class="line">		response.setContentType(<span class="string">"text/html;charset="</span>+encoding1);</span><br><span class="line">		response.setCharacterEncoding(encoding1);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	chain.doFilter(request, response);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>到此为止就完成了用过滤器设置字符编码任务。</p>
<p>完整代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebFilter</span>(</span><br><span class="line">    filterName=<span class="string">"CharactorFilter"</span>,</span><br><span class="line">	urlPatterns= &#123;<span class="string">"/*"</span>&#125;,</span><br><span class="line">	initParams= &#123;<span class="meta">@WebInitParam</span>(name=<span class="string">"encoding"</span>,value=<span class="string">"UTF-8"</span>)&#125;</span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CharactorFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">	String encoding=<span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Default constructor. </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CharactorFilter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated constructor stub	</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@see</span> Filter#init(FilterConfig)</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig fConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		encoding=fConfig.getInitParameter(<span class="string">"encoding"</span>);<span class="comment">//获取初始化参数encoding的值</span></span><br><span class="line">		System.out.println(<span class="string">"编码 格式过滤器启动"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@see</span> Filter#destroy()</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"编码 格式过滤器关闭"</span>);</span><br><span class="line">		encoding=<span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@see</span> Filter#doFilter(ServletRequest, ServletResponse, FilterChain)</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(encoding!=<span class="keyword">null</span>) &#123;<span class="comment">//判断字符编码是否为空</span></span><br><span class="line">			<span class="comment">//设置请求的编码格式</span></span><br><span class="line">			request.setCharacterEncoding(encoding);</span><br><span class="line">			<span class="comment">//设置response字符编码</span></span><br><span class="line">			response.setContentType(<span class="string">"text/html;charset="</span>+encoding);</span><br><span class="line">			response.setCharacterEncoding(encoding);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		chain.doFilter(request, response);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="JSP页面里面的-lt-page-……-gt-是什么玩意儿？"><a href="#JSP页面里面的-lt-page-……-gt-是什么玩意儿？" class="headerlink" title="JSP页面里面的&lt;%@ page   ……%&gt;是什么玩意儿？"></a>JSP页面里面的&lt;%@ page   ……%&gt;是什么玩意儿？</h3><h4 id="这行代码的作用"><a href="#这行代码的作用" class="headerlink" title="这行代码的作用"></a>这行代码的作用</h4><p>这里&lt;%@ page language=”java” contentType=”text/html; charset=UTF-8” pageEncoding=”UTF-8”%&gt;的作用是将JSP页面中使用的语言设置为java，将页面的MIME类型和字符编码设置为HTML类型且字符的编码为UTF-8，页面的编码格式指定为UTF-8。</p>
<h4 id="lt-page-gt-是页面指令page。"><a href="#lt-page-gt-是页面指令page。" class="headerlink" title="&lt;%@ page%&gt;是页面指令page。"></a>&lt;%@ page%&gt;是页面指令page。</h4><p>其作用是定义整个JSP页面相关属性，比如JSP页面的编码、内容类型及引用的类库等，当这些属性被服务器解析成Servlet时会转换为相应的java程序代码。</p>
<h4 id="page指令的语法格式"><a href="#page指令的语法格式" class="headerlink" title="page指令的语法格式"></a>page指令的语法格式</h4><p>如下：</p>
<p><code>&lt;@  page  属性1=“属性值1”   “属性2”=“属性值2” …&gt;</code></p>
<ul>
<li>page:声明指令为page指令</li>
<li>属性：指定page指令中的属性名</li>
<li>属性值：指定属性值</li>
</ul>
<h4 id="这里使用了language属性、contentType属性和pageEncoding属性。"><a href="#这里使用了language属性、contentType属性和pageEncoding属性。" class="headerlink" title="这里使用了language属性、contentType属性和pageEncoding属性。"></a>这里使用了language属性、contentType属性和pageEncoding属性。</h4><ul>
<li>language属性：指定当前页面中使用的语言，目前只支持java语言。</li>
<li>contentType属性：设置JSP页面的MIME类型和字符编码，浏览器会根据该属性指定的类型和编码显示网页内容。</li>
<li>pageEncoding属性：设置JSP页面的编码格式，在JSP页面中所有代码都使用该属性指定的字符集。</li>
</ul>
<h4 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h4><p>通常情况下，pageEncoding和contentType属性会同时存在，<strong>前者的作用是指定JSP页面的编码格式</strong>，<strong>后者的作用是指定服务器处理请求完成后，回应给浏览器的内容类型</strong>。</p>
<h3 id="request-getParameter-和request-getAttribute-的区别"><a href="#request-getParameter-和request-getAttribute-的区别" class="headerlink" title="request.getParameter()和request.getAttribute()的区别"></a>request.getParameter()和request.getAttribute()的区别</h3><h4 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h4><p>刚开始的时候，我在filter.jsp想要输出用户名和密码使用了request.getAttribute()，结果浏览器上给我显示的是两个null，我就很奇怪，然后我又用request.getParameter()试了一下，结果显示出来了，这是怎么回事呢？于是我查了一下这两个的区别。对于大佬们可能这么问题根本不值一提，但对于我这种菜鸟需要了解一下。</p>
<h4 id="获取的对象不同"><a href="#获取的对象不同" class="headerlink" title="获取的对象不同"></a>获取的对象不同</h4><ul>
<li><p>getAttribute()表示从request范围取得设置的属性，必须要通过setAttribute设置属性，才能通过getAttribute取得。设置和取得的值都是<strong>Object类型</strong>。</p>
</li>
<li><p>getParameter()表示接收页面提交的 参数，主要有表单提交的参数、URL重写传递的参数等，所以不需要通过setParameter来设置参数，而且参数的返回类型是String类型。中的id值）等，所以不需要通过setParameter来设置参数，而且参数的返回类型是<strong>String类型</strong>。</p>
</li>
</ul>
<h4 id="数据传递路径不同"><a href="#数据传递路径不同" class="headerlink" title="数据传递路径不同"></a>数据传递路径不同</h4><ul>
<li><p>request.getAttribute ()其实是取的web容器里面的值。 request.setAttribute()和getAttribute()方法传递的数据只会存在于Web容器内部，在具有转发关系的Web组件之间共享。</p>
</li>
<li><p>request.getParameter()获取通过get或者post方式提交上来的参数，是从客户端获取的</p>
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/18/项目一总结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wangwei">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="二十一的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/04/18/项目一总结/" class="post-title-link" itemprop="url">项目一总结</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-04-18 15:06:52" itemprop="dateCreated datePublished" datetime="2019-04-18T15:06:52+08:00">2019-04-18</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-05-07 23:17:27" itemprop="dateModified" datetime="2019-05-07T23:17:27+08:00">2019-05-07</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="一、数据库连接：JDBC"><a href="#一、数据库连接：JDBC" class="headerlink" title="一、数据库连接：JDBC"></a>一、数据库连接：JDBC</h2><h3 id="1-加载JDBC驱动"><a href="#1-加载JDBC驱动" class="headerlink" title="1.加载JDBC驱动"></a>1.加载JDBC驱动</h3><p>代码：Class.forname(com.mysql.cj.jdbc.Driver);</p>
<p>JDBC   API是一系列数据库的接口，它使得应用程序能够进行数据库连接，执行SQL语句，并且得到返回结果。</p>
<p>java直接面向JDBC编程，JDBC给我们提供一种接口和方法，MySQL，Oracle，SQLserver，DB2提供这种接口的实现，用的是一种多态。数据库想要支持java语言访问，必须提供JDBC这种接口的实现，这种接口的实现就叫JDBC驱动。</p>
<p>需要包mysql-connector-java-8.0.15.jar</p>
<p>成功加载后，会将Driver类的实例注册到DriverManager类中。这些驱动需要数据库提供，不同的数据库提供不同的驱动，实现JDBC接口。</p>
<h3 id="2-连接MySQL数据库"><a href="#2-连接MySQL数据库" class="headerlink" title="2.连接MySQL数据库"></a>2.连接MySQL数据库</h3><p>代码：Connection conn = DriverManager.getConnection(url,username,password);</p>
<p>JDBC URL: jdbc:mysql://<host>:<port>/&lt;database_name&gt;</port></host></p>
<p>默认端口3306，如果服务器使用默认端口则port可以省略</p>
<p>MySQL Connector/J Driver 允许在URL中添加额外的连接属性</p>
<h3 id="3-创建一个statement"><a href="#3-创建一个statement" class="headerlink" title="3.创建一个statement"></a>3.创建一个statement</h3><p>代码：Statement stmt = con.createStatement();</p>
<p>要执行SQL语句，必须获得java.sql.Statement实例，Statement实例分为以下3种类型：</p>
<p>1、执行静态SQL语句。通常通过Statement实例实现。</p>
<p>2、执行动态SQL语句。通常通过PreparedStatement实例实现。</p>
<p>3、执行数据库存储过程。通常通过CallableStatement实例实现。</p>
<h3 id="4-执行SQL"><a href="#4-执行SQL" class="headerlink" title="4.执行SQL"></a>4.执行SQL</h3><p>代码：ResultSet rs = stmt.executeQuery(SQL语句) ;</p>
<p>​           int rows = stmt.executeUpdate(SQL语句) ;</p>
<p>​           boolean flag = stmt.execute(SQL语句) ;</p>
<p>Statement接口提供了三种执行SQL语句的方法：executeQuery 、executeUpdate和execute 。</p>
<p>1、ResultSet executeQuery(String sqlString)：执行查询数据库的SQL语句，返回一个结果集（ResultSet）对象。</p>
<p>2、int executeUpdate(String sqlString)：用于执行INSERT、UPDATE或DELETE语句，如：CREATE TABLE和DROP TABLE等</p>
<p>3、execute(sqlString):用于执行返回多个结果集、多个更新计数或二者组合的语句。</p>
<h3 id="5-处理结果"><a href="#5-处理结果" class="headerlink" title="5.处理结果"></a>5.处理结果</h3><p>两种情况：</p>
<p>1.执行更新返回的是本次操作影响到的记录数。</p>
<p>2.执行查询返回的结果是一个ResultSet对象。</p>
<p>ResultSet包含符合SQL语句中条件的所有行，并且它通过一套get方法提供了对这些<br>行中数据的访问。<br>使用结果集（ResultSet）对象的访问方法获取数据：<br>while(rs.next()){<br>String name = rs.getString(“name”) ;<br>String pass = rs.getString(1) ; // 此方法比较高效<br>}</p>
<h3 id="6-关闭JDBC对象，释放资源"><a href="#6-关闭JDBC对象，释放资源" class="headerlink" title="6.关闭JDBC对象，释放资源"></a>6.关闭JDBC对象，释放资源</h3><p>操作完成以后要把所有使用的JDBC对象全都关闭，以释放JDBC资源，关闭顺序和声明顺序相反：<br>1、关闭记录集<br>2、关闭声明<br>3、关闭连接对象<br>if(rs != null){ // 关闭记录集<br>try{<br>rs.close() ;<br>}catch(SQLException e){<br>e.printStackTrace() ;<br>}<br>}<br>if(stmt != null){ // 关闭声明<br>try{<br>stmt.close() ;<br>}catch(SQLException e){<br>e.printStackTrace() ;<br>}<br>}<br>if(conn != null){ // 关闭连接对象<br>try{<br>conn.close() ;<br>}catch(SQLException e){<br>e.printStackTrace() ;<br>}<br>}</p>
<p>一般将三、四、五步骤封装成一个方法，来执行不同功能。</p>
<h2 id="二、文件压缩"><a href="#二、文件压缩" class="headerlink" title="二、文件压缩"></a>二、文件压缩</h2><h3 id="1-流程："><a href="#1-流程：" class="headerlink" title="1.流程："></a>1.流程：</h3><p>步骤一：判断当前文件是文件夹还是单个文件？</p>
<p>   步骤二：若是文件夹，在判断当前文件夹是否为空？</p>
<p>​       步骤三：若是空文件夹则直接压缩，注意要在末尾加上‘/’</p>
<p>​       步骤三：若不是空文件夹，递归遍历子文件，返回步骤一，再对               每个子文件判断是否为文件夹</p>
<p>步骤四：  若是单个文件，压缩单个文件</p>
<h3 id="2-java-util-zip常用的类"><a href="#2-java-util-zip常用的类" class="headerlink" title="2.java.util.zip常用的类"></a>2.java.util.zip常用的类</h3><p>ZipOutputStream   文件压缩的输出流</p>
<p>ZipEntry 压缩文件的子文件对象，用于保存压缩文件中文件及其文件夹的一个实列</p>
<p>除了用到上述类以外，还需要java.io下的类，只要与文件打交道，这个包就是必须的OutputStream 写出流(字节流)。</p>
<p>FileOutputStream 文件的写出流(字节流)，OutputStream的子类，用于内存到硬盘的写出。</p>
<p>InputStream 读取流(字节流)。</p>
<p>FileInputStream 文件的读取流(字节流)，InputStream的子类，用于读取文件到内存。</p>
<p>另外，还需要java.util.Enumeration这个类，用于列举zip压缩包的所有项。</p>
<p>以上就是文件压缩与解压的常用类，下面讲解压缩的核心函数。</p>
<p>ZipOutputStream类,该类主要用于压缩文件</p>
<ul>
<li><p>该类的构造函数需要至少需要一个参数，OutputStream输出流</p>
</li>
<li><p>setEncoding(); 该函数用于设置编码，解决中文乱码问题，一般设置为GBK或UTF-8，需要的注意的是，该函数只存在与org.apache.tools.zip这个包里，原生java.util.zip里面是没有这个函数的哦。</p>
</li>
<li><p>putNextEntry(ZipEntry e);该函数用于添加一个压缩子文件或子文件夹，它需要一个ZipEntry对象。举一个例子说名该函数，如果在压缩文件中创建一个子文件夹，那么就是putNextEntry(new ZipEntry(“Test/“));该语句就会在压缩文中，添加一个Test文件夹，注意，如果没有”/“，那么将创建一个Test文件。</p>
</li>
</ul>
<h3 id="3-代码"><a href="#3-代码" class="headerlink" title="3.代码"></a>3.代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//先将文件加载到文件流FileInputStream中，再将文件流输入到ZipOutputStream；</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ZipCompressing</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> k = <span class="number">1</span>; <span class="comment">// 定义递归次数变量  </span></span><br><span class="line"></span><br><span class="line"><span class="comment">//zipFileName 所要压缩的文件的目录+压缩包名           inputFile要压缩的文件</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">zip</span><span class="params">(String zipFileName, File inputFile)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">	</span><br><span class="line">    System.out.println(<span class="string">"压缩中..."</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//ZipOutputStream ：DeflaterOutputStream的一个子类，把数据压缩成Zip文件格式。</span></span><br><span class="line">    <span class="comment">//此类实现输出流过滤器，用于以ZIP文件格式写入文件。包括对压缩和未压缩条目的支持</span></span><br><span class="line">    <span class="comment">//压缩输出流</span></span><br><span class="line">    ZipOutputStream out = <span class="keyword">new</span> ZipOutputStream(<span class="keyword">new</span> FileOutputStream(zipFileName));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//BufferedOutputStream是缓冲输出流,继承于FilterOutputStream,作用是为另一个输出流提供“缓冲功能”</span></span><br><span class="line">    <span class="comment">//为ZipOutputStream提供一个缓冲输出流</span></span><br><span class="line">    <span class="comment">//该类实现缓冲输出流。</span></span><br><span class="line">    <span class="comment">//通过设置这样的输出流,应用程序可以将字节写入基础输出流，而不必为写入的每个字节调用底层系统。</span></span><br><span class="line">    BufferedOutputStream bo = <span class="keyword">new</span> BufferedOutputStream(out); </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//调用压缩方法,该方法的参数为</span></span><br><span class="line">    <span class="comment">//ZipOutputStream out压缩输出流对象</span></span><br><span class="line">    <span class="comment">// File inputFile要压缩的文件</span></span><br><span class="line">    <span class="comment">// File inputFile.getName()要压缩文件的名字</span></span><br><span class="line">    <span class="comment">// BufferedOutputStream bo缓冲输出流对象</span></span><br><span class="line">    ZipByType(out, inputFile, inputFile.getName(), bo);</span><br><span class="line">  </span><br><span class="line">    bo.close();<span class="comment">//关闭缓冲输出流</span></span><br><span class="line">    out.close();<span class="comment">//关闭压缩输出流</span></span><br><span class="line">    System.out.println(<span class="string">"压缩完成"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ZipOutputStream out压缩输出流对象</span></span><br><span class="line"><span class="comment">// File inputFile要压缩的文件</span></span><br><span class="line"><span class="comment">// String base要压缩文件的路径</span></span><br><span class="line"><span class="comment">// BufferedOutputStream bo缓冲输出流对象</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ZipByType</span><span class="params">(ZipOutputStream out, File f, String base,</span></span></span><br><span class="line"><span class="function"><span class="params">        BufferedOutputStream bo)</span> <span class="keyword">throws</span> Exception </span>&#123; </span><br><span class="line"></span><br><span class="line"><span class="comment">//java中的isDirectory()是检查一个对象是否是文件夹。返回值是boolean类型的。如果是则返回true，否则返回false。</span></span><br><span class="line">        <span class="keyword">if</span> (f.isDirectory())&#123; <span class="comment">//如果是文件夹</span></span><br><span class="line">        	</span><br><span class="line">    	<span class="comment">//File.listFiles()返回值类型,File对象数组 ;数组中元素内容,File对象类型的【完整路径】</span></span><br><span class="line">        File[] fl = f.listFiles();<span class="comment">//将文件夹里面的各个文件路径存到File数组中</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (fl.length == <span class="number">0</span>)&#123;<span class="comment">//如果是空文件夹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ZipEntry 压缩文件的子文件对象，用于保存压缩文件中文件及其文件夹的一个实列</span></span><br><span class="line"><span class="comment">//putNextEntry(ZipEntry e);该函数用于添加一个压缩子文件或子文件夹，它需要一个ZipEntry对象。</span></span><br><span class="line"><span class="comment">//举一个例子说名该函数，如果在压缩文件中创建一个子文件夹，那么就是putNextEntry(new ZipEntry("Test/"));</span></span><br><span class="line"><span class="comment">//该语句就会在压缩文中，添加一个Test文件夹，注意，如果没有"/"，那么将创建一个Test文件。</span></span><br><span class="line">                out.putNextEntry(<span class="keyword">new</span> ZipEntry(base + <span class="string">"/"</span>)); <span class="comment">// 创建zip压缩进入点base</span></span><br><span class="line">                System.out.println(base + <span class="string">"/"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        <span class="comment">//如果不是空文件夹,递归遍历子文件,再对每个子文件判断是否为文件夹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fl.length; i++) &#123;</span><br><span class="line">        	ZipByType(out, fl[i], base + <span class="string">"/"</span> + fl[i].getName(), bo); </span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"第"</span> + k + <span class="string">"次递归"</span>);</span><br><span class="line">        k++;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (f.isFile()) &#123;<span class="comment">//如果不是文件夹而是单个文件</span></span><br><span class="line">        out.putNextEntry(<span class="keyword">new</span> ZipEntry(base)); <span class="comment">// 创建ZipEntry用于标记压缩文件中含有的条目</span></span><br><span class="line">        System.out.println(base);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//FileInputStream流 被称为文件字节输入流，意思指对文件数据以字节的形式进行读取操作如读取图片视频等</span></span><br><span class="line">        FileInputStream in = <span class="keyword">new</span> FileInputStream(f);</span><br><span class="line"></span><br><span class="line"><span class="comment">//BufferedInputStream 的作用是为另一个输入流添加一些功能，例如，提供“缓冲功能”以及支持mark()标记和reset()重置方法。</span></span><br><span class="line"><span class="comment">//BufferedInputStream 本质上是通过一个内部缓冲区数组实现的。</span></span><br><span class="line"><span class="comment">//例如，在新建某输入流对应的BufferedInputStream后，当我们通过read()读取输入流的数据时，</span></span><br><span class="line"><span class="comment">//BufferedInputStream会将该输入流的数据分批的填入到缓冲区中。</span></span><br><span class="line"><span class="comment">//每当缓冲区中的数据被读完之后，输入流会再次填充数据缓冲区；如此反复，直到我们读完输入流数据位置。</span></span><br><span class="line">        BufferedInputStream bi = <span class="keyword">new</span> BufferedInputStream(in);</span><br><span class="line">        <span class="keyword">int</span> b;</span><br><span class="line">          </span><br><span class="line"><span class="comment">//BufferedInputStream.read()里面</span></span><br><span class="line"><span class="comment">//当pos大于等于count的时候，证明buf数组中已经没有可以获取的数据，则需要fill()方法来扩充或者补充buf中的数据，</span></span><br><span class="line"><span class="comment">//如果经过fill()方法后，pos仍旧大于等于count，则代表stream已经被读完，则返回-1，代表已经被读完。</span></span><br><span class="line"><span class="comment">//如果经过fill()方法pos已经小于count或者本身pos已经小于count，那么直接返回buf[pos]上的数据，pos并自加准备取下一个位置上的数据。</span></span><br><span class="line">            <span class="keyword">while</span> ((b = bi.read()) != -<span class="number">1</span>) &#123;</span><br><span class="line">            bo.write(b); <span class="comment">// 将字节流写入当前zip目录</span></span><br><span class="line">        &#125;</span><br><span class="line">        bo.flush(); <span class="comment">//要注意在使用BufferedOutputStream写完数据后，要调用flush()方法或close()方法，</span></span><br><span class="line">                    <span class="comment">//强行将缓冲区中的数据写出.否则可能无法写出数据。</span></span><br><span class="line">                    <span class="comment">//此处不能使用close(),因为使用close()之后的文件就无法缓存,只能使用flush()</span></span><br><span class="line">                    <span class="comment">//刷新此缓冲的输出流,这会强制将任何缓冲的输出字节写出到底层输出流</span></span><br><span class="line">        bi.close();<span class="comment">//关闭缓存输入流</span></span><br><span class="line">        in.close(); <span class="comment">//关闭输入流</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ZipCompressing book = <span class="keyword">new</span> ZipCompressing();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        book.zip(<span class="string">"C:\\Users\\95645\\Desktop\\upload.zip"</span>,<span class="keyword">new</span> File(<span class="string">"C:\\Users\\95645\\eclipse-workspace\\.metadata\\.plugins\\org.eclipse.wst.server.core\\tmp0\\webapps\\javaweb_v1.1\\upload"</span>));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/29/java学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wangwei">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="二十一的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/03/29/java学习/" class="post-title-link" itemprop="url">java学习</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-03-29 17:04:45" itemprop="dateCreated datePublished" datetime="2019-03-29T17:04:45+08:00">2019-03-29</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-05-07 23:18:16" itemprop="dateModified" datetime="2019-05-07T23:18:16+08:00">2019-05-07</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-使用eclipse遇到的问题"><a href="#1-使用eclipse遇到的问题" class="headerlink" title="1.使用eclipse遇到的问题"></a>1.使用eclipse遇到的问题</h1><h2 id="1-1怎样用eclipse编写第一个helloworld程序"><a href="#1-1怎样用eclipse编写第一个helloworld程序" class="headerlink" title="1.1怎样用eclipse编写第一个helloworld程序"></a>1.1怎样用eclipse编写第一个helloworld程序</h2><p>此处不做过多介绍,相关操作请点击<a href="https://jingyan.baidu.com/article/9c69d48fefa53113c9024eb3.html" target="_blank" rel="noopener">链接</a></p>
<h2 id="1-2用eclipse怎么进行代码调试"><a href="#1-2用eclipse怎么进行代码调试" class="headerlink" title="1.2用eclipse怎么进行代码调试"></a>1.2用eclipse怎么进行代码调试</h2><ol>
<li>首先要设置断点  设置断点的方法:在代码里需要调试的地方，鼠标双击代码行号的左边，  再次双击即可取消断点。<img src="/2019/03/29/java学习/断点.png" title="This is an image"></li>
<li>开始调试 方法一: 点击功能区里的小瓢虫开始调试; 方法二: 鼠标点击main方法–&gt;右键Debug As–&gt;Java Application开始java代码调试; 方法三: 快捷键F11;<img src="/2019/03/29/java学习/调试.png" title="This is an image"></li>
<li>进行调试 快捷键F5:表示进入当前方法内部，一步一步执行， 快捷键F6:表示运行下一行代码，执行当前行,但不进入执行细节， 快捷键F7:表示退出当前方法，返回到调用层。 快捷键F8:表示当前继续执行代码，直到遇到下一个断点.</li>
</ol>
<h2 id="1-3调试完成后怎么返回java视图"><a href="#1-3调试完成后怎么返回java视图" class="headerlink" title="1.3调试完成后怎么返回java视图?"></a>1.3调试完成后怎么返回java视图?</h2><p>通过IDE右上角的两个按钮进行切换<br><img src="/2019/03/29/java学习/切换.png" title="This is an image"></p>
<h2 id="1-4怎么修改文件名称"><a href="#1-4怎么修改文件名称" class="headerlink" title="1.4怎么修改文件名称?"></a>1.4怎么修改文件名称?</h2><p>用鼠标点一文件,然后点File-&gt;Rename<br><img src="/2019/03/29/java学习/换名.png" title="This is an image"></p>
<h2 id="1-5怎么恢复默认界面"><a href="#1-5怎么恢复默认界面" class="headerlink" title="1.5怎么恢复默认界面?"></a>1.5怎么恢复默认界面?</h2><p>恢复默认界面window-&gt;perspective-&gt;reset perspective<br><img src="/2019/03/29/java学习/界面.png" title="This is an image"></p>
<h2 id="1-6怎么设置字体大小"><a href="#1-6怎么设置字体大小" class="headerlink" title="1.6怎么设置字体大小?"></a>1.6怎么设置字体大小?</h2><p>设置字体大小window-&gt;preferences-&gt;general-&gt;appearance-&gt;colors and fonts<br><img src="/2019/03/29/java学习/字体设置.png" title="This is an image"></p>
<h2 id="1-7怎么显示行号"><a href="#1-7怎么显示行号" class="headerlink" title="1.7怎么显示行号?"></a>1.7怎么显示行号?</h2><p>编辑区最左边右键show line numbers,显示行号.<br><img src="/2019/03/29/java学习/行号显示.png" title="This is an image"></p>
<hr>
<h1 id="2-常用快捷键"><a href="#2-常用快捷键" class="headerlink" title="2.常用快捷键"></a>2.常用快捷键</h1><ul>
<li>添加单行注释:Ctrl+/(取消:Ctrl+/)</li>
<li>添加多行注释:Shift+Ctrl+/(取消:Shift+Ctrl+/)</li>
<li>向下复制一行:Ctrl+Alt+向下(向上同理)</li>
<li>向上移动代码:Alt+向上(向下同理)</li>
<li>格式化代码:Ctrl+Shift+F(注意关闭搜狗输入法里面相同的快捷键)</li>
<li>智能提示:Alt+/</li>
<li>同时选中所有相同内容:Alt+Shift+R</li>
<li><p>自动导包:Ctrl+Shift+O(前提是有main方法)</p>
<hr>
<h1 id="3-基本语法"><a href="#3-基本语法" class="headerlink" title="3.基本语法:"></a>3.基本语法:</h1></li>
</ul>
<h2 id="3-1-数据类型"><a href="#3-1-数据类型" class="headerlink" title="3.1 数据类型"></a>3.1 数据类型</h2><p>java数据类型有两种:<br> 1.基本数据类型(包括4类8种):</p>
<ul>
<li>逻辑类型:boolean  只有true和false两个值,<br>区别于C/C++不能用0代表false,用&gt;=1的值代表true</li>
<li>整数类型:整型默认为int型 <ul>
<li>byte型:    1个字节//区别于C/C++新增的类型</li>
<li>short型:   2个字节</li>
<li>int型:     4个字节</li>
<li>long型:    8个字节</li>
</ul>
</li>
<li>字符类型:  char,2个字节</li>
<li>浮点类型:浮点型默认为double型<ul>
<li>float型:   4个字节  数值后面要跟f或F</li>
<li>double型:  8个字节  </li>
</ul>
</li>
</ul>
<p>2.引用数据类型:除了基本类型,其他的都是引用类型.有数组,类,接口,Lambda等(引用理解起来和C/C++里面的指针类似).</p>
<h2 id="3-2-输入输出"><a href="#3-2-输入输出" class="headerlink" title="3.2 输入输出"></a>3.2 输入输出</h2><ul>
<li>使用引用类型Scanner进行输入.<br>  引用类型的使用一般分为三个步骤:<br>  1.导包<br>  <code>import java.util.Scanner;</code><br>  2.创建<br>  <code>Scanner sc=new Scanner(System.in);</code><br>  其中System.in代表从键盘输入<br>  3.使用<br>  a)获取键盘输入的数字<br>  <code>int num=sc.nextInt();</code><br>  b)获取键盘输入的字符串<br>  <code>String str=sc.next();</code></li>
</ul>
<p>什么是包?</p>
<blockquote>
<p>为了更好地组织类，Java提供了包机制。包是类的容器，用于分隔类名空间。如果没有指定包名，所有的示例都属于一个默认的无名包。<br>Java中的包一般均包含相关的类，例如，所有关于交通工具的类都可以放到名为Transportation的包中。<br>程序员可以使用package指明源文件中的类属于哪个具体的包。包语句的格式为：<br>package pkg1[．pkg2[．pkg3…]]；</p>
</blockquote>
<ul>
<li>输出<br>  <code>System.out.println();//输出时换行,ln代表换行</code><br>  <code>System.out.print();//输出时不换行</code><br>  <code>System.out.printf();//也有支持C语言输出的方式</code></li>
</ul>
<h2 id="3-3-数组"><a href="#3-3-数组" class="headerlink" title="3.3 数组"></a>3.3 数组</h2><ul>
<li>数组属于引用类型</li>
<li><p>声明数组<br>Java 中定义数组的语法有两种：<br>type arrayName[];<br>type[] arrayName;<br>例:<code>int a[];</code>或者<code>int[] a</code><br>与C/C++不同,Java不允许在声明数组中的方括号内指定数组元素的个数.<br>特别注意:<br><code>int []a,b[];</code>等价的声明是<code>int a[],b[][];</code></p>
</li>
<li><p>数组初始化<br><code>int []array=new array[5];//动态初始化,指定数组长度</code><br><code>int []array={1,2,3,4,5}//静态初始化,指定数组内容</code></p>
</li>
<li><p>遍历数组当中的元素</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>[] a=<span class="keyword">new</span> <span class="keyword">int</span> [<span class="number">5</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;a.length;i++)&#123;</span><br><span class="line">System.out.println(a[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以写成:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>[] a=<span class="keyword">new</span> <span class="keyword">int</span> [<span class="number">5</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i:a)&#123;</span><br><span class="line">System.out.println(a[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Java中的数组是对象。数组保存的仅仅是对象的引用，而不是对象本。<br>在C/C++中，我们定义的变量所需的空间都是分配在栈上的，而new所需的空间都是分配在堆上的,在栈上的变量必须在代码中明确指出大小，所以在C/C++中定义数组必须指定大小,而JAVA中所有的变量都是引用，换个角度理解就是C++中的指针，所以在JAVA中的变量都是后期分配的。</p>
<h2 id="3-4-java内存分配"><a href="#3-4-java内存分配" class="headerlink" title="3.4 java内存分配"></a>3.4 java内存分配</h2><ol>
<li>栈(Stack):主要用来存放局部变量</li>
<li>堆(Heap):凡是new出来的东西，都在堆当中。堆当中的数据有默认规则：<br>a) 如果是整数，默认是0；<br>b)如果是浮点数，默认是0.0；<br>c)如果是字符型，默认是’\u0000’(Unicode写法)；<br>d)如果是布尔类型，默认是false；<br>e)如果是引用类型(包含字符串)，默认是null(空常量)。</li>
<li>方法区：存放与.class相关的信息</li>
<li>本地方法区：与操作系统相关</li>
<li>寄存器：与CPU相关</li>
</ol>
<h2 id="3-5-运算符"><a href="#3-5-运算符" class="headerlink" title="3.5 运算符"></a>3.5 运算符</h2><p>1.算术运算符：+，-，*，/，%<br>2.自增、自减运算符：++，–<br>3.关系运算符：&gt;,&lt;,&gt;=,&lt;=,==,!=<br>4.赋值运算符：=<br>5.位运算符：按位与&amp;，按位或|，按位非~，按位异或^</p>
<ul>
<li><p>基本运算符与C/C++类似,不再过多描述，若想了解更多，请点击此<a href="https://jingyan.baidu.com/article/67662997949e9154d51b8493.html" target="_blank" rel="noopener">链接</a></p>
</li>
<li><p>instanceof运算符<br>该运算符是二目运算符,左边的操作元是一个对象,右边的是一个类当左边的对象是右边的类或子类创建的对象时,该运算符运算的结果是true,否则是false.</p>
</li>
</ul>
<h2 id="3-6-表达式与语句"><a href="#3-6-表达式与语句" class="headerlink" title="3.6 表达式与语句"></a>3.6 表达式与语句</h2><p> if条件分支语句,switch开关语句,for循环语句,while循环语句,break和continue语句与C/C++相似,不再过多叙述.</p>
<h2 id="3-7方法的定义与调用"><a href="#3-7方法的定义与调用" class="headerlink" title="3.7方法的定义与调用"></a>3.7方法的定义与调用</h2><ul>
<li>定义一个方法的格式<br>修饰符 返回值类型 方法名称(参数类型 参数名){<br>方法体;<br>return 返回值;<br>}</li>
</ul>
<p>例：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>方法重载：方法的名称相同,但是参数列表不同<br>例：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">sum</span><span class="params">(<span class="keyword">double</span> a,<span class="keyword">double</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>注意：重载与返回值类型无关，与参数名称无关。<br>参数表不同包括：参数的个数不同，参数的类型不同，参数的顺序不同。</p>
<ul>
<li>参数传递的原则</li>
</ul>
<p>基本数据类型参数传递<br><img src="/2019/03/29/java学习/jiben.png" title="This is an image"></p>
<p>引用数据类型参数传递<br><img src="/2019/03/29/java学习/yinyong.png" title="This is an image"></p>
<h1 id="4-类与对象"><a href="#4-类与对象" class="headerlink" title="4.类与对象"></a>4.类与对象</h1><h2 id="4-1类的定义与使用"><a href="#4-1类的定义与使用" class="headerlink" title="4.1类的定义与使用"></a>4.1类的定义与使用</h2><ol>
<li><p>如何定义类？<br>类是用来模拟现实世界事物的代码手段，事物分成属性和行为两个部分，类当中也包含两个部分：<br>a)成员变量(属性)：将变量定义在类中，在方法外，即为成员变量<br>b)成员方法(行为)：将普通的方法去掉static即为成员方法</p>
</li>
<li><p>如何使用类?<br>类是一种引用类型，使用起来可以分为三个步骤：<br>a)导包<br>如果需要使用的目标类和当前的类（含main方法）位于同一个包下，那么可以省略导包不写；否则需要使用import导包语句</p>
<p>b)创建<br>类名称  对象名 = new 类名称（）;</p>
<p>c)使用<br>使用成员变量：对象名.成员变量名<br>使用成员方法：对象名.成员方法名(参数)</p>
<p>例：键盘输入的操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;<span class="comment">//导包</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ScannerString</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		Scanner sc = <span class="keyword">new</span> Scanner(System.in);<span class="comment">//创建</span></span><br><span class="line">		System.out.println(<span class="string">"请输入字符串:"</span>);</span><br><span class="line">		String str = sc.next();<span class="comment">//使用</span></span><br><span class="line">		System.out.println(<span class="string">"字符串为: "</span> + str);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="4-2-构造方法"><a href="#4-2-构造方法" class="headerlink" title="4.2 构造方法"></a>4.2 构造方法</h2><p>构造方法就是专门用来创建对象的方法。当通过new关键字创建对象时，其实就是在调用构造方法。</p>
<p>构造方法的格式和C++类的构造方法相同：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> 构造方法名(参数类型 参数名)&#123;</span><br><span class="line">方法体</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>注意 ：构造方法没有返回值类型，并且构造方法名要和类名一样</p>
<p>创建一个类的时候，写好成员变量后可以快速添加构造函数，如下图：<br><img src="/2019/03/29/java学习/添加构造函数.png" title="This is an image"></p>
<p>也可以为每个成员变量快速添加getter和setter函数，如下图：<br></p>
<h2 id="4-3对象的创建与使用"><a href="#4-3对象的创建与使用" class="headerlink" title="4.3对象的创建与使用"></a>4.3对象的创建与使用</h2><ul>
<li><p>对象的创建<br>格式：<br>类的名字  对象名字；</p>
</li>
<li><p>对象的使用：<br>对象操作自己的变量(体现对象的属性)<br>对象.变量</p>
<p>对象调用类中的方法：<br>对象.方法</p>
</li>
</ul>
<h2 id="4-4-垃圾收集机制"><a href="#4-4-垃圾收集机制" class="headerlink" title="4.4 垃圾收集机制"></a>4.4 垃圾收集机制</h2><p>和C++不同，在java语言中，类有构造方法，但没有析构方法，java运行环境有“垃圾收集”机制，因此不必像C++程序员那样，要时刻自己检查哪些对象应该使用析构方法释放内存，java运行环境的“垃圾收集”发现堆中分配的实体不再被栈中任何对象引用时，就会释放该实体在堆中占用的内存。因此java很少出现“内存泄漏”，即由于程序忘记释放内存所导致的内存溢出。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">wangwei</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">7</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              

              
            </nav>
          

          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">wangwei</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.0.1</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/schemes/muse.js?v=7.0.1"></script>



  

  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  

  

  

  



  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
